<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>math/polygon.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Ball.html">Ball</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#.collide">collide</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#.fromObject">fromObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#applyDeltaVelInPoint">applyDeltaVelInPoint</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#collided">collided</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#containsPoint">containsPoint</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#effectiveMass">effectiveMass</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#getAmInPoint">getAmInPoint</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#move">move</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#rotate">rotate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#toJSON">toJSON</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Ball.html#velInPlace">velInPlace</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Body.html">Body</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#.collide">collide</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#.fromObject">fromObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#applyDeltaVelInPoint">applyDeltaVelInPoint</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#calculateAxes">calculateAxes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#calculatePosAndMass">calculatePosAndMass</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#collideWithBall">collideWithBall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#collideWithFixedBall">collideWithFixedBall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#collideWithWall">collideWithWall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#containsPoint">containsPoint</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#effectiveMass">effectiveMass</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#getAmInPoint">getAmInPoint</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#move">move</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#rotate">rotate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#support">support</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#toJSON">toJSON</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#velInPlace">velInPlace</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Line.html">Line</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Line.html#.intersect">intersect</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Line.html#.intersectWithLineSegment">intersectWithLineSegment</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Line.html#distFromPoint">distFromPoint</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="LineSegment.html">LineSegment</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="LineSegment.html#.intersect">intersect</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="LineSegment.html#distFromPoint">distFromPoint</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="MinMax.html">MinMax</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Physics.html">Physics</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#.fromObject">fromObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#addBall">addBall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#addBody">addBody</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#addFixedBall">addFixedBall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#addRectBody">addRectBody</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#addRectWall">addRectWall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#addSoftBall">addSoftBall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#addSoftSquare">addSoftSquare</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#addSpring">addSpring</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#addWall">addWall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#getCopyOfBalls">getCopyOfBalls</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#getCopyOfBodies">getCopyOfBodies</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#getObjectAtCoordinates">getObjectAtCoordinates</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#getObjectIdentifier">getObjectIdentifier</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#removeObjFromSystem">removeObjFromSystem</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#setAirFriction">setAirFriction</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#setBounds">setBounds</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#setGravity">setGravity</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#softBallFromObject">softBallFromObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#stickOrSpringFromObject">stickOrSpringFromObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#toJSON">toJSON</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Physics.html#update">update</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Polygon.html">Polygon</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Polygon.html#.createCircle">createCircle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Polygon.html#.fracture">fracture</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Polygon.html#.intersection">intersection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Polygon.html#getSideLine">getSideLine</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Polygon.html#getSideSegment">getSideSegment</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Polygon.html#getSideVector">getSideVector</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Polygon.html#isPointInside">isPointInside</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Polygon.html#makeAntiClockwise">makeAntiClockwise</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Polygon.html#reverseOrder">reverseOrder</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SoftBall.html">SoftBall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SoftBall.html#.updatePressureBasedForces">updatePressureBasedForces</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SoftBall.html#containsPoint">containsPoint</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Spring.html">Spring</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Spring.html#attachObject">attachObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Spring.html#lockRotation">lockRotation</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Spring.html#pinHere">pinHere</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Spring.html#unlockRotation">unlockRotation</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Spring.html#unpin">unpin</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Spring.html#update">update</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Stick.html">Stick</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stick.html#update">update</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Vec2.html">Vec2</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#add">add</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#dist">dist</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#div">div</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#lerp">lerp</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#mult">mult</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#normalize">normalize</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#pNorm">pNorm</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#rotate">rotate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#rotate90">rotate90</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#rotate270">rotate270</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#setCoordinates">setCoordinates</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#setMag">setMag</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#sub">sub</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#toJSON">toJSON</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.add">add</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.angle">angle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.angleACW">angleACW</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.cross">cross</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.crossScalarFirst">crossScalarFirst</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.crossScalarSecond">crossScalarSecond</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.dist">dist</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.div">div</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.dot">dot</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.fromAngle">fromAngle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.fromAnglePNorm">fromAnglePNorm</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.fromObject">fromObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.lerp">lerp</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.mult">mult</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.normalized">normalized</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.rotateArr">rotateArr</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Vec2.html#.sub">sub</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Wall.html">Wall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wall.html#.fromObject">fromObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wall.html#calculateAxes">calculateAxes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wall.html#calculateBoundingBox">calculateBoundingBox</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wall.html#calculateCenterAndRadius">calculateCenterAndRadius</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wall.html#collideWithBall">collideWithBall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wall.html#containsPoint">containsPoint</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wall.html#toJSON">toJSON</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#arrayBuffertoBase64">arrayBuffertoBase64</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#base64ToArrayBuffer">base64ToArrayBuffer</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#codeTable">codeTable</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#collisionResponse">collisionResponse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#collisionResponseWithWall">collisionResponseWithWall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#detectCollision">detectCollision</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#detectCollisionGJK">detectCollisionGJK</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#findOverlap">findOverlap</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#minMaxOfArray">minMaxOfArray</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">math/polygon.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Vec2 from './vec2';
import LineSegment from './linesegment';
import Line from './line';

/** @typedef {(Vec2|import('./vec2').Vec2AsObject)} Vec2Like */

/**
 * Class representing a mathematical polygon
 */
class Polygon {
  /**
   * Creates the polygon
   *
   * @param {Vec2Like[]} points_ Array of the
   * points for the polygon in order
   */
  constructor(points_) {
    if (points_.length &lt; 3) {
      throw new Error(
        'Not enough points in polygon (minimum required: 3)',
      );
    }
    this.points = points_;
    this.makeAntiClockwise();
  }

  /**
   * Returns the vector of the side with the given number
   * The vector has the orientation of the order of the points
   *
   * @param {number} i The number of the side
   * @returns {Vec2} The side vector
   */
  getSideVector(i) {
    let num = i;
    if (num &lt; 0) num += Math.abs(Math.floor(num)) * this.points.length;
    return Vec2.sub(this.points[(num + 1) % this.points.length],
      this.points[num % this.points.length]);
  }

  /**
   * Returns the side with the given number as a LineSegment
   *
   * @param {number} i The number of the side
   * @returns {LineSegment} The side line segment
   */
  getSideSegment(i) {
    let num = i;
    if (num &lt; 0) num += Math.abs(Math.floor(num)) * this.points.length;
    return new LineSegment(Vec2.fromObject(this.points[(num + 1) % this.points.length]),
      Vec2.fromObject(this.points[num % this.points.length]));
  }

  /**
   * Returns the side with the given number as a Line
   *
   * @param {number} i The number of the side
   * @returns {Line} The side line
   */
  getSideLine(i) {
    let num = i;
    if (num &lt; 0) num += Math.abs(Math.floor(num)) * this.points.length;
    return new LineSegment(Vec2.fromObject(this.points[(num + 1) % this.points.length]),
      Vec2.fromObject(this.points[num % this.points.length]));
  }

  /**
   * @returns {number} The number of sides of the polygon
   */
  get sides() {
    return this.points.length;
  }

  /**
   * Turns the order of the points to anticlockwise,
   * which is the standard in mathematics
   */
  makeAntiClockwise() {
    let angleSum = 0;

    for (let i = 1; i &lt;= this.sides; i += 1) {
      const vec1 = this.getSideVector(i);
      const vec2 = this.getSideVector(i - 1);
      vec2.mult(-1);
      angleSum += Vec2.angleACW(vec1, vec2);
    }

    if (this.sides === 3) {
      if (angleSum > Math.PI * 1.5) this.reverseOrder();
    } else if (this.sides === 4) {
      if (Vec2.angleACW(this.getSideVector(1),
        this.getSideVector(0)) >= Math.PI) {
        this.reverseOrder();
      }
    } else if (this.sides > 4) {
      const realAngle = angleSum - this.sides * Math.PI;
      if (realAngle > 0) {
        this.reverseOrder();
      }
    }
  }

  /**
   * Reverses the order of points in the polygon
   */
  reverseOrder() {
    this.points = this.points.reverse();
  }

  /**
   * Determines if a given point is inside the polygon or not
   *
   * @param {Vec2|import('./vec2').Vec2AsObject} point The point to investigate
   * @returns {boolean} If the point is inside or not
   */
  isPointInside(point) {
    const p = new Vec2(point.x, point.y);
    if (Vec2.dist(p, this.centerPoint) > this.boundRadius) return false;

    // Find a point that is outside of the shape for sure
    const outsidePoint = this.centerPoint.copy;
    outsidePoint.add(Vec2.mult(new Vec2(1.1, 0.6), this.boundRadius));

    // Create a LineSegment between the points
    const segment = new LineSegment(p, outsidePoint);

    // Count the intersections
    let intersectionCount = 0;
    [...Array(this.sides).keys()]
      .map((number) => this.getSideSegment(number)).forEach((side) => {
        if (LineSegment.intersect(side, segment)) intersectionCount += 1;
      });

    if (intersectionCount % 2 === 0) return false;
    if (intersectionCount % 2 === 1) return true;
    return false;
  }

  /**
   * Returns the mathematical average of the point of the polygon
   *
   * @returns {Vec2} The center point
   */
  get centerPoint() {
    const center = new Vec2(0, 0);
    this.points.forEach((p) => {
      center.add(p);
    });
    center.div(this.sides);
    return center;
  }

  /**
   * Returns the radius of the smallest possible
   * circle containing the whole polygon centered
   * around the polygon's centerPoint
   * The circle's center is the centerPoint of the polygon
   *
   * @returns {number} The radius
   */
  get boundRadius() {
    const center = this.centerPoint;
    return Math.max(...this.points.map((p) => Vec2.dist(p, center)));
  }

  /**
   * @returns {LineSegment[]} Array containing the sides of the polygon
   */
  get allSides() {
    return [...Array(this.sides).keys()]
      .map((number) => this.getSideSegment(number));
  }

  /**
   * Determines the intersecting area of two polygons.
   * Returns undefined if there is none.
   *
   * @param {Polygon} poly1 The first polygon
   * @param {Polygon} poly2 The second polygon
   * @returns {Polygon | undefined} The intersection area
   */
  static intersection(poly1, poly2) {
    if (Vec2.dist(poly1.centerPoint, poly2.centerPoint)
      > poly1.boundRadius + poly2.boundRadius) return undefined;

    // Determine intersection points
    /**
     * @typedef IntersectionPoint
     * @property {number} x The x coordinate
     * @property {number} y The y coordinate
     * @property {boolean} [isIntersectionPoint] Indicates the intersection
     */
    /** @typedef {{intersectionPoint:IntersectionPoint,sideNum1:number,sideNum2:number}} SectData */
    /** @type {SectData[]} */
    const sideIntersections = [];
    const sides1 = poly1.allSides;
    const sides2 = poly2.allSides;
    sides1.forEach((side1, idx1) => {
      sides2.forEach((side2, idx2) => {
        /** @type {IntersectionPoint | boolean} */
        const intersectionOfSides = LineSegment.intersect(side1, side2);
        if (typeof intersectionOfSides === 'object' &amp;&amp; 'x' in intersectionOfSides) {
          intersectionOfSides.isIntersectionPoint = true;
          sideIntersections.push({
            intersectionPoint: intersectionOfSides,
            sideNum1: idx1,
            sideNum2: idx2,
          });
        }
      });
    });

    if (sideIntersections.length === 0) {
      if (poly1.isPointInside(poly2.points[0])) {
        return new Polygon(poly2.points.map((p) => Vec2.fromObject(p)));
      }
      if (poly2.isPointInside(poly1.points[0])) {
        return new Polygon(poly1.points.map((p) => Vec2.fromObject(p)));
      }
    }

    // Put the intersection points into the copy of polygons
    const new1 = new Polygon(poly1.points);
    for (let i = new1.points.length - 1; i >= 0; i -= 1) {
      const intersectionsOnThis = sideIntersections.filter((it) => it.sideNum1 === i);
      if (intersectionsOnThis.length > 1) {
        intersectionsOnThis.sort((a, b) => Vec2.dist(new1.points[i], a.intersectionPoint)
          - Vec2.dist(new1.points[i], b.intersectionPoint));
      }
      if (intersectionsOnThis.length > 0) {
        new1.points.splice(i + 1, 0,
          ...intersectionsOnThis.map((it) => it.intersectionPoint));
      }
    }
    const new2 = new Polygon(poly2.points);
    for (let i = new2.points.length - 1; i >= 0; i -= 1) {
      const intersectionsOnThis = sideIntersections.filter((it) => it.sideNum2 === i);
      if (intersectionsOnThis.length > 1) {
        intersectionsOnThis.sort((a, b) => Vec2.dist(new2.points[i], a.intersectionPoint)
          - Vec2.dist(new2.points[i], b.intersectionPoint));
      }
      if (intersectionsOnThis.length > 0) {
        new2.points.splice(i + 1, 0,
          ...intersectionsOnThis.map((it) => it.intersectionPoint));
      }
    }

    // Find a starting point outside of the other poly
    const currInv = {
      polyNum: 1,
      pointNum: 0,
    };
    for (let i = 0; i &lt; new1.points.length; i += 1) {
      if ('isIntersectionPoint' in new1.points[i]) {
        currInv.pointNum = i;
        break;
      } else if (new2.isPointInside(new1.points[i])) {
        currInv.pointNum = i;
        break;
      }
    }
    const isDone = false;
    const finalPoints = [];
    while (!isDone) {
      const currentPoly = (currInv.polyNum === 1) ? new1 : new2;
      const otherPoly = (currInv.polyNum === 1) ? new2 : new1;
      finalPoints.push(
        Vec2.fromObject(currentPoly.points[
          currInv.pointNum % currentPoly.points.length]),
      );
      if (finalPoints.length > 2
        &amp;&amp; finalPoints[0].x === finalPoints[finalPoints.length - 1].x
        &amp;&amp; finalPoints[0].y === finalPoints[finalPoints.length - 1].y) {
        finalPoints.pop();
        break;
      }
      if (finalPoints.length > new1.points.length + new2.points.length) {
        break;
      }

      if ('isIntersectionPoint' in currentPoly.points[currInv.pointNum
        % currentPoly.points.length]) {
        if ('isIntersectionPoint' in currentPoly.points[(currInv.pointNum + 1)
          % currentPoly.points.length]) {
          currInv.pointNum += 1;
        } else if (otherPoly.isPointInside(
          currentPoly.points[(currInv.pointNum + 1)
          % currentPoly.points.length],
        )
          &amp;&amp; !('isIntersectionPoint' in currentPoly.points[(currInv.pointNum + 1)
            % currentPoly.points.length])) {
          currInv.pointNum += 1;
        } else {
          currInv.pointNum = otherPoly.points.indexOf(
            currentPoly.points[currInv.pointNum
            % currentPoly.points.length],
          ) + 1;
          currInv.polyNum = (currInv.polyNum === 1) ? 2 : 1;
        }
      } else {
        currInv.pointNum += 1;
      }
    }

    return new Polygon(finalPoints);
  }

  /**
   * Creates a regular polygon (circle) with
   * the given center point and radius
   *
   * @param {number} radius The radius of the circle
   * @param {Vec2} center The center of the circle
   * @param {number} resolution The resolution of the circle
   * @returns {Polygon} The created Polygon
   */
  static createCircle(radius, center, resolution = 25) {
    const pts = [...Array(resolution).keys()].map((number) => {
      const p = Vec2.fromAngle((2 * Math.PI * number) / resolution);
      p.setMag(radius);
      p.add(center);
      return p;
    });
    return new Polygon(pts);
  }

  /**
   * Creates a fracture diagram based on the given points
   * Looks like a Voronoi diagram
   *
   * @param {Vec2[]} middlePoints Points of fractures
   * @param {number} maxLength Max length of sides on the peripherals
   * @returns {Polygon[]} The fractured shapes
   */
  static fracture(middlePoints, maxLength = 500) {
    const shapes = middlePoints.map((p, i) => {
      /** @type {Line[]} */
      let lines = [];
      for (let j = 0; j &lt; middlePoints.length; j += 1) {
        if (i !== j) {
          const otherPoint = middlePoints[j];
          const avg = Vec2.div(Vec2.add(p, otherPoint), 2);
          const e = Vec2.sub(p, otherPoint);
          e.rotate(Math.PI / 2);

          lines.push(new Line(avg, Vec2.add(e, avg)));
        }
      }

      lines = lines.filter((line, idx) => {
        const connectingSegment = new LineSegment(line.a, p);
        for (let j = 0; j &lt; lines.length; j += 1) {
          if (idx !== j) {
            const sectP = Line.intersectWithLineSegment(lines[j], connectingSegment);
            if (sectP) return false;
          }
        }
        return true;
      });

      lines = lines.sort((a, b) => Vec2.sub(a.a, a.b).heading - Vec2.sub(b.a, b.b).heading);

      const shape = lines.map((line, index) => {
        /** @type {Vec2[]} */
        let intersectPoints = [];
        for (let j = 0; j &lt; lines.length; j += 1) {
          if (index !== j) {
            const newIntersection = Line.intersect(line, lines[j]);
            if (newIntersection instanceof Vec2) intersectPoints.push(newIntersection);
          }
        }
        const e = Vec2.sub(line.a, line.b);
        intersectPoints = intersectPoints.filter((ip) => {
          const v = Vec2.sub(ip, p);
          e.setMag(1);
          const dist = Vec2.dot(v, e);
          return dist > 0;
        });
        if (intersectPoints.length === 0) {
          intersectPoints.push(Vec2.add(Vec2.mult(e, maxLength * 1.2), line.a));
        }
        intersectPoints = intersectPoints.sort((a, b) => Vec2.dist(a, p) - Vec2.dist(b, p));
        return intersectPoints[0];
      });

      return shape;
    });

    return shapes.filter((shape) => shape.length >= 3).map((shape) => new Polygon(shape));
  }
}

export default Polygon;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Thu Jan 07 2021 01:58:00 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
