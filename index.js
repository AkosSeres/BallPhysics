(()=>{var k=class{constructor(t,e){this.x=t,this.y=e}get copy(){return new k(this.x,this.y)}setCoordinates(t,e){this.x=t,this.y=e}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}get sqlength(){return this.x*this.x+this.y*this.y}get heading(){if(this.x===0&&this.y===0)return 0;if(this.x===0)return this.y>0?Math.PI/2:1.5*Math.PI;if(this.y===0)return this.x>0?0:Math.PI;let t=k.normalized(this);return this.x>0&&this.y>0?Math.asin(t.y):this.x<0&&this.y>0?Math.asin(-t.x)+Math.PI/2:this.x<0&&this.y<0?Math.asin(-t.y)+Math.PI:this.x>0&&this.y<0?Math.asin(t.x)+1.5*Math.PI:0}add(t){this.x+=t.x,this.y+=t.y}sub(t){this.x-=t.x,this.y-=t.y}mult(t){this.x*=t,this.y*=t}div(t){this.x/=t,this.y/=t}lerp(t,e){this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e}dist(t){return new k(this.x-t.x,this.y-t.y).length}pNorm(t){let e=t;return e<1&&(e=1),(Math.abs(this.x**e)+Math.abs(this.y**e))**(1/e)}setMag(t){this.length!==0&&this.mult(t/this.length)}normalize(){this.length!==0&&this.div(this.length)}scaleAround(t,e){this.x=t.x+(this.x-t.x)*e,this.y=t.y+(this.y-t.y)*e}scaleAroundX(t,e){this.x=t.x+(this.x-t.x)*e}scaleAroundY(t,e){this.y=t.y+(this.y-t.y)*e}rotate(t){let e=Math.cos(t),n=Math.sin(t);this.setCoordinates(this.x*e-this.y*n,this.x*n+this.y*e)}static rotateArr(t,e){let n=Math.cos(e),o=Math.sin(e);t.forEach(a=>{a.setCoordinates(a.x*n-a.y*o,a.x*o+a.y*n)})}rotate90(){let{x:t}=this;this.x=-this.y,this.y=t}rotate270(){let{x:t}=this;this.x=this.y,this.y=-t}static add(t,e){return new k(t.x+e.x,t.y+e.y)}static sub(t,e){return new k(t.x-e.x,t.y-e.y)}static mult(t,e){return new k(t.x*e,t.y*e)}static div(t,e){return new k(t.x/e,t.y/e)}static fromAngle(t){return new k(Math.cos(t),Math.sin(t))}static fromAnglePNorm(t,e){let n=new k(Math.cos(t),Math.sin(t));return n.div(n.pNorm(e)),n}static lerp(t,e,n){return k.add(t,k.mult(k.sub(e,t),n))}static dist(t,e){return k.sub(t,e).length}static dot(t,e){return t.x*e.x+t.y*e.y}static cross(t,e){return t.x*e.y-t.y*e.x}static crossScalarFirst(t,e){return new k(-e.y*t,e.x*t)}static crossScalarSecond(t,e){return new k(t.y*e,-t.x*e)}static angle(t,e){return Math.acos(Math.min(Math.max(k.dot(t,e)/Math.sqrt(t.sqlength*e.sqlength),1),-1))}static angleACW(t,e){let n=t.heading,a=e.heading-n;return a<0?2*Math.PI+a:a}static normalized(t){let e=t.length;return e===0?t:new k(t.x/e,t.y/e)}toJSON(){return{x:this.x,y:this.y}}static fromObject(t){return new k(t.x,t.y)}},i=k;var Wt=class{constructor(t,e){this.a=t,this.b=e}get length(){return i.dist(this.a,this.b)}distFromPoint(t){let e=i.sub(this.b,this.a),n=e.length;e.normalize();let o=i.sub(t,this.a),a=i.dot(e,o),r=i.cross(e,o);return a>=0&&a<=n?Math.abs(r):Math.sqrt(Math.min(o.sqlength,i.sub(t,this.b).sqlength))}get nearestPointO(){let t=i.sub(this.b,this.a);if(i.dot(this.a,t)>=0)return this.a.copy;if(i.dot(this.b,t)<=0)return this.b.copy;t.normalize();let e=-i.dot(this.a,t);return i.add(this.a,i.mult(t,e))}static intersect(t,e){let n=i.sub(t.b,t.a),o=n.y/n.x,a=t.b.y-t.b.x*o,r=i.sub(e.b,e.a),c=r.y/r.x,d=e.b.y-e.b.x*c;if(n.x===0&&r.x!==0){if(t.a.x>=e.a.x&&t.a.x<=e.b.x||t.a.x<=e.a.x&&t.a.x>=e.b.x){let m=c*t.a.x+d;if(m>t.a.y&&m<t.b.y||m<t.a.y&&m>t.b.y)return new i(t.a.x,m)}return!1}if(r.x===0&&n.x!==0){if(e.a.x>=t.a.x&&e.a.x<=t.b.x||e.a.x<=t.a.x&&e.a.x>=t.b.x){let m=o*e.a.x+a;if(m>e.a.y&&m<e.b.y||m<e.a.y&&m>e.b.y)return new i(e.a.x,m)}return!1}if(n.x===0&&r.x===0){if(t.a.x===e.a.x){let m;t.a.y<t.b.y?m=[t.a.y,t.b.y]:m=[t.b.y,t.a.y];let y;e.a.y<e.b.y?y=[e.a.y,e.b.y]:y=[e.b.y,e.a.y];let g=[m[0]>y[0]?m[0]:y[0],m[1]<y[1]?m[1]:y[1]];if(g[0]<=g[1])return new i(t.a.x,(g[0]+g[1])/2)}return!1}let u;t.a.x<t.b.x?u=[t.a.x,t.b.x]:u=[t.b.x,t.a.x];let h;e.a.x<e.b.x?h=[e.a.x,e.b.x]:h=[e.b.x,e.a.x];let l=[u[0]>h[0]?u[0]:h[0],u[1]<h[1]?u[1]:h[1]];if(o===c&&a===d&&l[0]<=l[1])return new i((l[0]+l[1])/2,(l[0]+l[1])/2*o+a);let p=(d-a)/(o-c);return p>=l[0]&&p<=l[1]?new i(p,p*o+a):!1}},C=Wt;var Gt=class extends C{get length(){return Number.POSITIVE_INFINITY}distFromPoint(t){let e=i.sub(this.a,this.b);e.setMag(1),e.rotate(Math.PI/2);let n=i.sub(t,this.a);return Math.abs(i.dot(n,e))}static intersect(t,e){let n=i.sub(t.b,t.a),o=n.y/n.x,a=t.b.y-t.b.x*o,r=i.sub(e.b,e.a),c=r.y/r.x,d=e.b.y-e.b.x*c;if(o===c)return t.distFromPoint(e.a)===0?new i((t.a.x+t.b.x+e.a.x+e.b.x)/4,(t.a.y+t.b.y+e.a.y+e.b.y)/4):!1;let u=(d-a)/(o-c);return new i(u,o*u+a)}static intersectWithLineSegment(t,e){let n=i.sub(t.b,t.a),o=n.y/n.x,a=t.b.y-t.b.x*o,r=i.sub(e.b,e.a),c=r.y/r.x,d=e.b.y-e.b.x*c;if(n.x===0){if(r.x===0)return t.a.x===e.a.x?new i((e.a.x+e.b.x)/2,(e.a.y+e.b.y)/2):!1;let l=t.a.x,p=c*l+d;return Math.min(e.a.x,e.b.x)<l&&l<Math.max(e.a.x,e.b.x)&&Math.min(e.a.y,e.b.y)<p&&Math.max(e.a.y,e.b.y)>p?new i(l,p):!1}if(r.x===0){let l=e.a.x,p=o*l+a;return Math.min(e.a.x,e.b.x)<l&&l<Math.max(e.a.x,e.b.x)&&Math.min(e.a.y,e.b.y)<p&&Math.max(e.a.y,e.b.y)>p?new i(l,p):!1}if(o===c)return t.distFromPoint(e.a)===0?new i((e.a.x+e.b.x)/2,(e.a.y+e.b.y)/2):!1;let u=(d-a)/(o-c),h=o*u+a;return Math.min(e.a.x,e.b.x)<u&&u<Math.max(e.a.x,e.b.x)&&Math.min(e.a.y,e.b.y)<h&&Math.max(e.a.y,e.b.y)>h?new i(u,h):!1}},W=Gt;function A(s,t){this.min=s,this.max=t}A.prototype.size=function(){return this.max-this.min};function ft(s){return new A(Math.min(...s),Math.max(...s))}function pt(s,t){return new A(Math.max(s.min,t.min),Math.min(s.max,t.max))}var H=class{constructor(t){if(t.length<3)throw new Error("Not enough points in polygon (minimum required: 3)");this.points=t,this.makeAntiClockwise()}getSideVector(t){let e=t;return e<0&&(e+=Math.abs(Math.floor(e))*this.points.length),i.sub(this.points[(e+1)%this.points.length],this.points[e%this.points.length])}getSideSegment(t){let e=t;return e<0&&(e+=Math.abs(Math.floor(e))*this.points.length),new C(i.fromObject(this.points[(e+1)%this.points.length]),i.fromObject(this.points[e%this.points.length]))}getSideLine(t){let e=t;return e<0&&(e+=Math.abs(Math.floor(e))*this.points.length),new C(i.fromObject(this.points[(e+1)%this.points.length]),i.fromObject(this.points[e%this.points.length]))}get sides(){return this.points.length}makeAntiClockwise(){let t=0;for(let e=1;e<=this.sides;e+=1){let n=this.getSideVector(e),o=this.getSideVector(e-1);o.mult(-1),t+=i.angleACW(n,o)}this.sides===3?t>Math.PI*1.5&&this.reverseOrder():this.sides===4?i.angleACW(this.getSideVector(1),this.getSideVector(0))>=Math.PI&&this.reverseOrder():this.sides>4&&t-this.sides*Math.PI>0&&this.reverseOrder()}reverseOrder(){this.points=this.points.reverse()}isPointInside(t){let e=new i(t.x,t.y);if(i.dist(e,this.centerPoint)>this.boundRadius)return!1;let n=this.centerPoint.copy;n.add(i.mult(new i(1.1,.6),this.boundRadius));let o=new C(e,n),a=0;return[...Array(this.sides).keys()].map(r=>this.getSideSegment(r)).forEach(r=>{C.intersect(r,o)&&(a+=1)}),a%2==0?!1:a%2==1}get centerPoint(){let t=new i(0,0);return this.points.forEach(e=>{t.add(e)}),t.div(this.sides),t}get boundRadius(){let t=this.centerPoint;return Math.max(...this.points.map(e=>i.dist(e,t)))}get allSides(){return[...Array(this.sides).keys()].map(t=>this.getSideSegment(t))}static intersection(t,e){if(i.dist(t.centerPoint,e.centerPoint)>t.boundRadius+e.boundRadius)return;let n=[],o=t.allSides,a=e.allSides;if(o.forEach((l,p)=>{a.forEach((m,y)=>{let g=C.intersect(l,m);typeof g=="object"&&"x"in g&&(g.isIntersectionPoint=!0,n.push({intersectionPoint:g,sideNum1:p,sideNum2:y}))})}),n.length===0){if(t.isPointInside(e.points[0]))return new H(e.points.map(l=>i.fromObject(l)));if(e.isPointInside(t.points[0]))return new H(t.points.map(l=>i.fromObject(l)))}let r=new H(t.points);for(let l=r.points.length-1;l>=0;l-=1){let p=n.filter(m=>m.sideNum1===l);p.length>1&&p.sort((m,y)=>i.dist(r.points[l],m.intersectionPoint)-i.dist(r.points[l],y.intersectionPoint)),p.length>0&&r.points.splice(l+1,0,...p.map(m=>m.intersectionPoint))}let c=new H(e.points);for(let l=c.points.length-1;l>=0;l-=1){let p=n.filter(m=>m.sideNum2===l);p.length>1&&p.sort((m,y)=>i.dist(c.points[l],m.intersectionPoint)-i.dist(c.points[l],y.intersectionPoint)),p.length>0&&c.points.splice(l+1,0,...p.map(m=>m.intersectionPoint))}let d={polyNum:1,pointNum:0};for(let l=0;l<r.points.length;l+=1)if("isIntersectionPoint"in r.points[l]){d.pointNum=l;break}else if(c.isPointInside(r.points[l])){d.pointNum=l;break}let u=!1,h=[];for(;!u;){let l=d.polyNum===1?r:c,p=d.polyNum===1?c:r;if(h.push(i.fromObject(l.points[d.pointNum%l.points.length])),h.length>2&&h[0].x===h[h.length-1].x&&h[0].y===h[h.length-1].y){h.pop();break}if(h.length>r.points.length+c.points.length)break;"isIntersectionPoint"in l.points[d.pointNum%l.points.length]?"isIntersectionPoint"in l.points[(d.pointNum+1)%l.points.length]||p.isPointInside(l.points[(d.pointNum+1)%l.points.length])&&!("isIntersectionPoint"in l.points[(d.pointNum+1)%l.points.length])?d.pointNum+=1:(d.pointNum=p.points.indexOf(l.points[d.pointNum%l.points.length])+1,d.polyNum=d.polyNum===1?2:1):d.pointNum+=1}return new H(h)}static createCircle(t,e,n=25){let o=[...Array(n).keys()].map(a=>{let r=i.fromAngle(2*Math.PI*a/n);return r.setMag(t),r.add(e),r});return new H(o)}static fracture(t,e=500){return t.map((o,a)=>{let r=[];for(let d=0;d<t.length;d+=1)if(a!==d){let u=t[d],h=i.div(i.add(o,u),2),l=i.sub(o,u);l.rotate(Math.PI/2),r.push(new W(h,i.add(l,h)))}return r=r.filter((d,u)=>{let h=new C(d.a,o);for(let l=0;l<r.length;l+=1)if(u!==l&&W.intersectWithLineSegment(r[l],h))return!1;return!0}),r=r.sort((d,u)=>i.sub(d.a,d.b).heading-i.sub(u.a,u.b).heading),r.map((d,u)=>{let h=[];for(let p=0;p<r.length;p+=1)if(u!==p){let m=W.intersect(d,r[p]);m instanceof i&&h.push(m)}let l=i.sub(d.a,d.b);return h=h.filter(p=>{let m=i.sub(p,o);return l.setMag(1),i.dot(m,l)>0}),h.length===0&&h.push(i.add(i.mult(l,e*1.2),d.a)),h=h.sort((p,m)=>i.dist(p,o)-i.dist(m,o)),h[0]})}).filter(o=>o.length>=3).map(o=>new H(o))}},kt=H;var K=class{constructor(){this.r=0,this.points=[new i(0,0)]}static Circle(t,e){let n=new K;return n.r=Math.abs(t),n.points[0]=e.copy,n}static Polygon(t){let e=new K;if(t.length<3)throw new Error("A polygon needs at least 3 points to be valid!");return e.points=new kt(t).points.map(n=>i.fromObject(n)),e}getGeometricalData(){let t={center:this.points[0].copy,area:0,secondArea:0};if(this.r!==0)t.area=this.r*this.r*Math.PI,t.secondArea=.5*Math.PI*this.r**4;else{let e=[];for(let r=2;r<this.points.length;r+=1)e.push([this.points[0],this.points[r-1],this.points[r]]);let n=0,o=0,a=new i(0,0);e.forEach(r=>{let c=Math.sqrt((r[0].x-r[1].x)**2+(r[0].y-r[1].y)**2),d=Math.sqrt((r[1].x-r[2].x)**2+(r[1].y-r[2].y)**2),u=Math.sqrt((r[2].x-r[0].x)**2+(r[2].y-r[0].y)**2),h=(c+d+u)/2,l=Math.sqrt(h*(h-c)*(h-d)*(h-u));n+=l,a.x+=l*(r[0].x+r[1].x+r[2].x)/3,a.y+=l*(r[0].y+r[1].y+r[2].y)/3}),a.div(n),t.center=a,t.area=n,e.forEach(r=>{let c=Math.sqrt((r[0].x-r[1].x)**2+(r[0].y-r[1].y)**2),d=Math.sqrt((r[1].x-r[2].x)**2+(r[1].y-r[2].y)**2),u=Math.sqrt((r[2].x-r[0].x)**2+(r[2].y-r[0].y)**2),h=(c+d+u)/2,l=Math.sqrt(h*(h-c)*(h-d)*(h-u)),m=new W(r[1],r[2]).distFromPoint(r[0]),y=i.sub(r[2],r[1]);y.rotate90(),y.add(r[1]),c=new W(r[1],y).distFromPoint(r[0]);let x=(d*d*d*m-d*d*m*c+d*m*c*c+d*m*m*m)/36;x+=new i((r[0].x+r[1].x+r[2].x)/3,(r[0].y+r[1].y+r[2].y)/3).dist(t.center)**2*l,o+=x}),t.secondArea=o}return t}getMinMaxX(){let t=ft(this.points.map(e=>e.x));return t.min-=this.r,t.max+=this.r,t}getMinMaxY(){let t=ft(this.points.map(e=>e.y));return t.min-=this.r,t.max+=this.r,t}getMinMaxInDirection(t){let e=ft(this.points.map(n=>i.dot(n,t)));return e.min-=this.r,e.max+=this.r,e}move(t){this.points.forEach(e=>e.add(t))}rotateAround(t,e){this.points.forEach(n=>{n.sub(t)}),i.rotateArr(this.points,e),this.points.forEach(n=>{n.add(t)})}containsPoint(t){if(this.r!==0)return i.sub(t,this.points[0]).sqlength<=this.r*this.r;if(this.points.length===4){let n=new i(this.getMinMaxX().max+10,this.getMinMaxY().max+10),o=new C(t,n),a=0;return this.sides.forEach(r=>{C.intersect(r,o)&&(a+=1)}),a%2==1}return this.points.map((n,o)=>{let a=i.sub(this.points[(o+1)%this.points.length],n);return a.rotate90(),a}).every((n,o)=>i.dot(n,i.sub(t,this.points[o]))>=0)}get sides(){return this.points.map((t,e)=>new C(t,this.points[(e+1)%this.points.length]))}getClosestPoint(t){let e=this.points.map(r=>i.sub(r,t).sqlength),n=e[0],o=0,a=e.length;for(let r=1;r<a;r+=1)e[r]<n&&(n=e[r],o=r);return this.points[o].copy}static fromObject(t){let e=new K;return e.r=t.r,e.points=t.points.map(n=>i.fromObject(n)),e}get copy(){let t=new K;return t.r=this.r,t.points=this.points.map(e=>e.copy),t}},O=K;var Pt={white:"#faf3dd",green:"#02c39a",pink:"#e58c8a",blue:"#3db2f1",black:"#363732",Beige:"#f2f3d9",Independence:"#38405f",Turquoise:"#5dd9c1","Rich Black FOGRA 29":"#0e131f","Independence 2":"#59546c","Roman Silver":"#8b939c","Imperial Red":"#ff0035","Hot Pink":"#fc6dab","Maximum Yellow Red":"#f5b841","Lavender Web":"#dcd6f7"},S=Pt,Ut=Pt.Turquoise,G=Pt.Turquoise;var He=15,rt=class{constructor(t,e=1,n=.2,o=.5){this.shape=t,this.k=n,this.fc=o;let a=this.shape.getGeometricalData();this.m=a.area*e,this.pos=a.center,this.am=a.secondArea*e,this.rotation=0,this.ang=0,this.vel=new i(0,0),this.layer=void 0,this.defaultAxes=[],this.axes=[],this.calculateAxes(),this.boundingBox={x:this.shape.getMinMaxX(),y:this.shape.getMinMaxY()},this.minMaxes=[],this.calculateMinMaxes(),this.style=G}calculateAxes(){let t=Math.cos(Math.PI/He);this.defaultAxes=this.normals.map(e=>new i(e.x,Math.abs(e.y)));for(let e=this.defaultAxes.length-2;e>=0;e-=1)for(let n=this.defaultAxes.length-1;n>e;n-=1){let o=this.defaultAxes[n],a=this.defaultAxes[e];Math.abs(i.dot(o,a))>t&&(this.defaultAxes.splice(n,1),this.defaultAxes[e]=o)}this.axes=this.defaultAxes.map(e=>e.copy)}calculateMinMaxes(){this.minMaxes=this.axes.map(t=>this.shape.getMinMaxInDirection(t))}get normals(){if(this.shape.r!==0)return[new i(0,1)];let t=this.shape.points.map((e,n)=>i.sub(this.shape.points[(n+1)%this.shape.points.length],e));return t.forEach(e=>{e.rotate270(),e.normalize()}),t}move(t){this.shape.move(t),this.pos.add(t),this.boundingBox.x.max+=t.x,this.boundingBox.x.min+=t.x,this.boundingBox.y.max+=t.y,this.boundingBox.y.min+=t.y}rotate(t){this.rotation+=t,this.shape.r===0&&this.shape.rotateAround(this.pos,t),i.rotateArr(this.axes,t),this.boundingBox={x:this.shape.getMinMaxX(),y:this.shape.getMinMaxY()}}velInPlace(t){let e=i.sub(t,this.pos);return e.rotate90(),e.mult(this.ang),e.add(this.vel),e}containsPoint(t){return this.shape.containsPoint(t)}get density(){return this.m/this.shape.getGeometricalData().area}set density(t){if(t<0||!Number.isFinite(t))return;let e=this.shape.getGeometricalData();this.m=e.area*t,this.am=e.secondArea*t}fixDown(){this.m=0}scaleAround(t,e){e!==0&&(this.pos.scaleAround(t,e),this.shape.points.forEach(n=>n.scaleAround(t,e)),this.shape.r=Math.abs(this.shape.r*e),this.m*=e**2,this.am*=e**4)}scaleAroundX(t,e){if(e===0)return;let{density:n}=this;this.shape.points.forEach(a=>a.scaleAroundX(t,e)),this.shape.r=Math.abs(this.shape.r*e);let o=this.shape.getGeometricalData();this.m=o.area*n,this.pos=o.center,this.am=o.secondArea*n,this.calculateAxes(),this.calculateMinMaxes()}scaleAroundY(t,e){if(e===0)return;let{density:n}=this;this.shape.points.forEach(a=>a.scaleAroundY(t,e)),this.shape.r=Math.abs(this.shape.r*e);let o=this.shape.getGeometricalData();this.m=o.area*n,this.pos=o.center,this.am=o.secondArea*n,this.calculateAxes(),this.calculateMinMaxes()}applyImpulse(t,e){if(this.m===0)return;let n=i.sub(t,this.pos);this.vel.add(i.div(e,this.m)),this.ang+=i.cross(n,e)/this.am}static detectCollision(t,e){let n=t,o=e;{let x=pt(n.boundingBox.x,o.boundingBox.x);if(x.max<x.min)return!1;let w=pt(n.boundingBox.y,o.boundingBox.y);if(w.max<w.min)return!1}let a=t.axes,r=e.axes;if(n.shape.r!==0){let x=o.shape.getClosestPoint(n.pos),w=i.sub(x,n.pos);w.normalize(),a=[w],n.minMaxes=[n.shape.getMinMaxInDirection(w)]}if(o.shape.r!==0){let x=n.shape.getClosestPoint(o.pos),w=i.sub(x,o.pos);w.normalize(),r=[w],o.minMaxes=[o.shape.getMinMaxInDirection(w)]}let c=[...a,...r],d=x=>n.shape.getMinMaxInDirection(x),u=x=>o.shape.getMinMaxInDirection(x),h=[];if(c.some((x,w)=>{let E;w<a.length?E=t.minMaxes[w]:E=d(x);let N;w>=a.length?N=e.minMaxes[w-a.length]:N=u(x);let P=pt(E,N);return P.max<P.min?!0:(h.push(P),!1)}))return!1;let l=h.map(x=>x.size()),p=l[0],m=0;for(let x=1;x<l.length;x+=1)p>l[x]&&(p=l[x],m=x);let y=c[m].copy;i.dot(y,i.sub(n.pos,o.pos))>0&&y.mult(-1);let g;if(m<a.length){let x=o.shape.points.map(w=>i.dot(w,y));g=o.shape.points[x.indexOf(Math.min(...x))].copy,o.shape.r!==0&&g.sub(i.mult(y,o.shape.r))}else{let x=n.shape.points.map(w=>i.dot(w,y));g=n.shape.points[x.indexOf(Math.max(...x))].copy,n.shape.r!==0&&g.add(i.mult(y,n.shape.r))}return{normal:y,overlap:p,contactPoint:g}}static fromObject(t){let e=Object.create(rt.prototype);return e.am=t.am,e.ang=t.ang,e.axes=t.axes.map(n=>i.fromObject(n)),e.boundingBox={x:new A(t.boundingBox.x.min,t.boundingBox.x.max),y:new A(t.boundingBox.y.min,t.boundingBox.y.max)},e.defaultAxes=t.defaultAxes.map(n=>i.fromObject(n)),e.fc=t.fc,e.k=t.k,e.layer=t.layer,e.m=t.m,e.pos=i.fromObject(t.pos),e.rotation=t.rotation,e.shape=O.fromObject(t.shape),e.style=t.style,e.vel=i.fromObject(t.vel),e.minMaxes=[],e.calculateMinMaxes(),e}get copy(){return rt.fromObject(this)}},v=rt;var Jt=class{constructor(t,e){this.length=t,this.springConstant=e,this.pinned=!1,this.objects=[],this.rotationLocked=!1,this.initialHeading=0,this.initialOrientations=[0,0],this.attachPoints=[],this.attachRotations=[],this.attachPositions=[]}pinHere(t,e){this.pinned={x:t,y:e}}unpin(){this.pinned=!1}attachObject(t,e=void 0){let n=this.objects;n.push(t),e?this.attachPoints.push(e.copy):this.attachPoints.push(t.pos.copy),this.attachPositions.push(t.pos.copy),this.attachRotations.push(t.rotation),n.length===2&&(this.pinned=!1),n.length>=3&&(n=[n[n.length-2],n[n.length-1]],this.attachPoints=[this.attachPoints[this.attachPoints.length-2],this.attachPoints[this.attachPoints.length-1]],this.attachPositions=[this.attachPositions[this.attachPositions.length-2],this.attachPositions[this.attachPositions.length-1]],this.attachRotations=[this.attachRotations[this.attachRotations.length-2],this.attachRotations[this.attachRotations.length-1]])}updateAttachPoint0(t,e=0){let n=this.rotationLocked;n&&this.unlockRotation(),this.attachPoints[0]=t.copy,this.attachPositions[0]=this.objects[0].pos.copy,this.attachRotations[0]=this.objects[0].rotation,this.attachPoints[0].dist(this.attachPositions[0])<=e&&(this.attachPoints[0]=this.attachPositions[0].copy),n&&this.lockRotation()}updateAttachPoint1(t,e=0){let n=this.rotationLocked;n&&this.unlockRotation(),this.objects.length===2?(this.attachPoints[1]=t.copy,this.attachPositions[1]=this.objects[1].pos.copy,this.attachRotations[1]=this.objects[1].rotation,this.attachPoints[1].dist(this.attachPositions[1])<=e&&(this.attachPoints[1]=this.attachPositions[1].copy)):typeof this.pinned!="boolean"&&(this.pinned=t.copy),n&&this.lockRotation()}get points(){let t=this.objects.map((e,n)=>{let o=i.sub(this.attachPoints[n],this.attachPositions[n]);return o.rotate(e.rotation-this.attachRotations[n]),i.add(o,e.pos)});return typeof this.pinned!="boolean"&&t.push(i.fromObject(this.pinned)),t}lockRotation(){this.rotationLocked=!0,this.initialOrientations=this.objects.map(e=>e.rotation);let t=this.points;this.initialHeading=i.sub(t[1],t[0]).heading}unlockRotation(){this.rotationLocked=!1}arrangeOrientations(){let t=this.points,n=i.sub(t[1],t[0]).heading-this.initialHeading;this.objects.forEach((o,a)=>{let r=this.initialOrientations[a]+n;o.rotate(r-o.rotation)})}getAsSegment(){let t=this.points;return new C(t[0],t[1])}update(t){this.rotationLocked&&this.arrangeOrientations();let e,n;if(this.pinned instanceof Object&&this.objects[0]){[n,e]=[this.pinned,this.objects[0]];let o=this.points,a=new i(o[1].x-o[0].x,o[1].y-o[0].y),r=a.length-this.length;a.setMag(1),a.mult(r*this.springConstant*t),e.applyImpulse(o[1],a);let c=e.vel;if(c.rotate(-a.heading),this.rotationLocked&&e.m!==0){let d=new i(n.x,n.y),h=i.sub(e.pos,d).length,l=h*h*e.m+e.am,p=(e.am*e.ang-h*e.m*c.y)/l;c.y=-p*h,e.ang=p}c.rotate(a.heading)}else if(this.objects[0]&&this.objects[1]){[e,n]=[this.objects[0],this.objects[1]];let o=this.points,a=i.sub(o[0],o[1]),r=a.length-this.length;a.setMag(1),a.mult(r*this.springConstant*t),n.applyImpulse(o[1],a),a.mult(-1),e.applyImpulse(o[0],a),a=i.sub(e.pos,n.pos);let c=e.vel,d=n.vel;if(c.rotate(-a.heading),d.rotate(-a.heading),this.rotationLocked&&e.m!==0&&n.m!==0){let u=new i(e.pos.x*e.m+n.pos.x*n.m,e.pos.y*e.m+n.pos.y*n.m);u.div(e.m+n.m);let h=i.sub(e.pos,u),l=i.sub(n.pos,u),p=h.length,m=l.length,y=p*p*e.m+e.am+m*m*n.m+n.am,g=(c.y-d.y)*m/(p+m)+d.y,x=(e.am*e.ang+n.am*n.ang+p*e.m*(c.y-g)-m*n.m*(d.y-g))/y;c.y=x*p+g,d.y=-x*m+g,e.ang=x,n.ang=x}c.rotate(a.heading),d.rotate(a.heading)}}},B=Jt;var Qt=class extends B{constructor(t){super(t,0);this.springConstant=0}updateAttachPoint0(t,e=0){let n=this.rotationLocked;n&&this.unlockRotation(),this.attachPoints[0]=t.copy,this.attachPositions[0]=this.objects[0].pos.copy,this.attachRotations[0]=this.objects[0].rotation,this.attachPoints[0].dist(this.attachPositions[0])<=e&&(this.attachPoints[0]=this.attachPositions[0].copy),this.length=this.getAsSegment().length,n&&this.lockRotation()}updateAttachPoint1(t,e=0){let n=this.rotationLocked;n&&this.unlockRotation(),this.objects.length===2?(this.attachPoints[1]=t.copy,this.attachPositions[1]=this.objects[1].pos.copy,this.attachRotations[1]=this.objects[1].rotation,this.attachPoints[1].dist(this.attachPositions[1])<=e&&(this.attachPoints[1]=this.attachPositions[1].copy)):typeof this.pinned!="boolean"&&(this.pinned=t.copy),this.length=this.getAsSegment().length,n&&this.lockRotation()}update(){this.rotationLocked&&this.arrangeOrientations();let t,e;if(this.pinned instanceof Object&&"x"in this.pinned&&this.objects[0]){if([e,t]=[this.pinned,this.objects[0]],t.m===0)return;let n=this.points,o=new i(n[1].x-n[0].x,n[1].y-n[0].y);o.setMag(o.length-this.length),t.move(o),o=new i(n[1].x-n[0].x,n[1].y-n[0].y),o.normalize();let a=n[0],r=o,c=t,d=i.sub(a,c.pos),u=i.mult(c.velInPlace(a),-1),h=1/c.m;h+=i.dot(i.crossScalarFirst(i.cross(d,r)/c.am,d),r),h=-i.dot(u,r)/h;let l=i.sub(c.vel,i.mult(r,h/c.m)),p=c.ang-h*i.cross(d,r)/c.am;t.vel=l,t.ang=p;let m=t.vel;if(m.rotate(-o.heading),this.rotationLocked&&t.m!==0){let y=new i(e.x,e.y),x=i.sub(t.pos,y).length,w=x*x*t.m+t.am,E=(t.am*t.ang+x*t.m*m.y)/w;m.y=E*x,t.ang=E}m.rotate(o.heading)}else if(this.objects[0]&&this.objects[1]){[t,e]=[this.objects[0],this.objects[1]];let n=this.points,o=i.sub(n[0],n[1]),a=this.length-o.length;o.setMag(1);let r=t,c=e,d=r.m===0?Infinity:r.m,u=c.m===0?Infinity:c.m,h,l;if(d!==Infinity&&u!==Infinity)h=i.mult(o,a*u/(d+u)),l=i.mult(o,-a*d/(d+u));else if(d===Infinity&&u!==Infinity)h=new i(0,0),l=i.mult(o,-a);else if(d!==Infinity&&u===Infinity)l=new i(0,0),h=i.mult(o,a);else return;t.move(h),e.move(l),n=this.points,o=i.sub(n[1],n[0]),o.normalize();let p=o,m=n[0],y=n[1],g=r.ang,x=c.ang,w=i.sub(m,r.pos),E=i.sub(y,c.pos),N=r.m===0?Infinity:r.am,P=c.m===0?Infinity:c.am,Q=r.velInPlace(m),$=c.velInPlace(y),j=i.sub($,Q),R=1/d+1/u;R+=i.dot(i.crossScalarFirst(i.cross(w,p)/N,w),p),R+=i.dot(i.crossScalarFirst(i.cross(E,p)/P,E),p),R=-i.dot(j,p)/R;let Z=i.sub(r.vel,i.mult(p,R/d)),it=i.add(c.vel,i.mult(p,R/u)),ot=g-R*i.cross(w,p)/N,X=x+R*i.cross(E,p)/P;t.m!==0&&(t.vel=Z,t.ang=ot),e.m!==0&&(e.vel=it,e.ang=X);let L=t.vel,F=e.vel;if(L.rotate(-o.heading),F.rotate(-o.heading),this.rotationLocked&&t.m!==0&&e.m!==0){let Mt=new i(t.pos.x*t.m+e.pos.x*e.m,t.pos.y*t.m+e.pos.y*e.m);Mt.div(t.m+e.m);let at=i.sub(t.pos,Mt).length,_=i.sub(e.pos,Mt).length,je=at*at*t.m+t.am+_*_*e.m+e.am,ut=(L.y-F.y)*_/(at+_)+F.y,mt=(t.am*t.ang+e.am*e.ang+at*t.m*(L.y-ut)-_*e.m*(F.y-ut))/je;L.y=mt*at+ut,F.y=-mt*_+ut,t.ang=mt,e.ang=mt}L.rotate(o.heading),F.rotate(o.heading)}}},Y=Qt;function qe(s,t,e,n){let o=n,a=e,r=s,c=t,d=r.vel,u=c.vel,h=r.ang,l=c.ang,p=i.sub(a,r.pos),m=i.sub(a,c.pos),y=r.am,g=c.am,x=r.m,w=c.m,E=(r.k+c.k)/2,N=(r.fc+c.fc)/2,P=r.velInPlace(a),Q=c.velInPlace(a),$=i.sub(Q,P),j=1/x+1/w;j+=i.dot(i.crossScalarFirst(i.cross(p,o)/y,p),o),j+=i.dot(i.crossScalarFirst(i.cross(m,o)/g,m),o),j=-((1+E)*i.dot($,o))/j;let R=i.sub(d,i.mult(o,j/x)),Z=i.add(u,i.mult(o,j/w)),it=h-j*i.cross(p,o)/y,ot=l+j*i.cross(m,o)/g,X=$.copy;if(X.sub(i.mult(o,i.dot($,o))),X.setMag(1),i.dot(o,X)**2>.5)return[{dVel:i.sub(R,r.vel),dAng:it-r.ang},{dVel:i.sub(Z,c.vel),dAng:ot-c.ang}];let L=1/x+1/w;L+=i.dot(i.crossScalarFirst(i.cross(p,X)/y,p),X),L+=i.dot(i.crossScalarFirst(i.cross(m,X)/g,m),X),L=-i.dot($,X)/L;let F=Math.sign(L)*j*N;return Math.abs(F)>Math.abs(L)&&(F=L),R=i.sub(R,i.mult(X,F/x)),Z=i.add(Z,i.mult(X,F/w)),it-=F*i.cross(p,X)/y,ot+=F*i.cross(m,X)/g,[{dVel:i.sub(R,r.vel),dAng:it-r.ang},{dVel:i.sub(Z,c.vel),dAng:ot-c.ang}]}function Kt(s,t,e){let n=t,o=e,a=s,r=i.sub(n,a.pos),{am:c,m:d}=a,u=i.mult(a.velInPlace(n),-1),h=1/d;h+=i.dot(i.crossScalarFirst(i.cross(r,o)/c,r),o),h=-((1+a.k)*i.dot(u,o))/h;let l=i.sub(a.vel,i.mult(o,h/d)),p=a.ang-h*i.cross(r,o)/c,m=u.copy;if(m.sub(i.mult(o,i.dot(u,o))),m.setMag(1),i.dot(o,m)**2>.5)return{dVel:i.sub(l,a.vel),dAng:p-a.ang};let y=1/d;y+=i.dot(i.crossScalarFirst(i.cross(r,m)/c,r),m),y=-i.dot(u,m)/y;let g=Math.sign(y)*h*a.fc;return Math.abs(g)>Math.abs(y)&&(g=y),l=i.sub(l,i.mult(m,g/d)),p-=g*i.cross(r,m)/c,{dVel:i.sub(l,a.vel),dAng:p-a.ang}}function $t(s){let t=[],e=s.length,n=Array(e).fill(0),o=Array(e).fill(0),a=Array(e).fill(0),r=Array(e).fill(0),c=Array(e).fill(0),d=Array(e).fill(0);s.forEach(u=>u.calculateMinMaxes());for(let u=0;u<e-1;u+=1)for(let h=u+1;h<e;h+=1){let l=s[u],p=s[h];if(l.m===0&&p.m===0)continue;let m=v.detectCollision(l,p);if(m&&typeof m!="boolean"){let y=i.dot(l.velInPlace(m.contactPoint),m.normal),g=i.dot(p.velInPlace(m.contactPoint),m.normal);t.push({n:m.normal,cp:m.contactPoint});let x=-m.overlap,w=m.overlap;if(l.m===0){x=0;let P=Kt(p,m.contactPoint,i.mult(m.normal,-1));r[h]+=P.dVel.x,c[h]+=P.dVel.y,d[h]+=P.dAng,a[h]+=1}else if(p.m===0){w=0;let P=Kt(l,m.contactPoint,i.mult(m.normal,1));r[u]+=P.dVel.x,c[u]+=P.dVel.y,d[u]+=P.dAng,a[u]+=1}else{x*=p.m/(l.m+p.m),w*=l.m/(l.m+p.m);let[P,Q]=qe(l,p,m.contactPoint,i.mult(m.normal,1));y>=g&&(r[u]+=P.dVel.x,c[u]+=P.dVel.y,d[u]+=P.dAng,r[h]+=Q.dVel.x,c[h]+=Q.dVel.y,d[h]+=Q.dAng)}let E=i.mult(m.normal,x),N=i.mult(m.normal,w);n[u]+=E.x,n[h]+=N.x,o[u]+=E.y,o[h]+=N.y}}for(let u=0;u<e;u+=1){let h=s[u];if(h.m===0)continue;let l=Math.max(a[u],1);h.move(new i(n[u],o[u])),h.vel.add(new i(r[u]/l,c[u]/l)),h.ang+=d[u]/l}return t}var ct=class{constructor(){this.bodies=[],this.springs=[],this.airFriction=1,this.gravity=new i(0,0)}update(t){let e=[];for(let n=0;n<this.bodies.length;n+=1)this.bodies[n].move(new i(this.bodies[n].vel.x*t,this.bodies[n].vel.y*t)),this.bodies[n].rotate(this.bodies[n].ang*t);for(let n=0;n<3;n+=1)this.springs.forEach(o=>{o.update(t/3/2)});for(let n=0;n<this.bodies.length;n+=1)this.bodies[n].m!==0&&this.bodies[n].vel.add(new i(this.gravity.x*t,this.gravity.y*t));e=$t(this.bodies);for(let n=0;n<3;n+=1)this.springs.forEach(o=>{o.update(t/3/2)});return this.bodies.forEach(n=>{let o=n;n.m!==0&&(o.vel.mult(this.airFriction**t),o.ang*=this.airFriction**t)}),e}get copy(){let t=this.toJSON();return ct.fromObject(t)}setAirFriction(t){!Number.isFinite(t)||(this.airFriction=t,this.airFriction<0&&(this.airFriction=0),this.airFriction>1&&(this.airFriction=1))}setGravity(t){this.gravity=t.copy}addBody(t){this.bodies.push(t)}addSoftSquare(t,e,n,o,a=24,r=1){let c={sides:[],points:[]},d=Math.sqrt(e*e/Math.PI);c.points=[...new Array(a).keys()].map(l=>2*l*Math.PI/a).map(l=>i.add(i.mult(i.fromAngle(l),d),t)).map(l=>new v(O.Circle(Math.PI*d/a,l),1,.2,n)),c.sides=c.points.map((l,p)=>{let m=new Y(1);return m.attachObject(l),m.attachObject(c.points[(p+1)%c.points.length]),p%2==0&&m.lockRotation(),m}),c.sides.forEach(l=>{let p=l;p.length=.96*4*e/a}),c.points.forEach(l=>{let p=l;p.vel=o.copy}),this.bodies.push(...c.points),this.springs.push(...c.sides);let u=e*e*200*r,h=new B(Math.sqrt(d*d*Math.PI),u/2);h.attachObject(c.points[0]),h.attachObject(c.points[a/2]),this.springs.push(h),h=new B(Math.sqrt(d*d*Math.PI),u/2),h.attachObject(c.points[a/4]),h.attachObject(c.points[3*a/4]),this.springs.push(h),h=new B(Math.sqrt(2*d*d*Math.PI),u),h.attachObject(c.points[a/8]),h.attachObject(c.points[5*a/8]),this.springs.push(h),h=new B(Math.sqrt(2*d*d*Math.PI),u),h.attachObject(c.points[3*a/8]),h.attachObject(c.points[7*a/8]),this.springs.push(h)}addRectWall(t,e,n,o){let a=[];a.push(new i(t-n/2,e-o/2)),a.push(new i(t+n/2,e-o/2)),a.push(new i(t+n/2,e+o/2)),a.push(new i(t-n/2,e+o/2)),this.bodies.push(new v(O.Polygon(a),0))}addRectBody(t,e,n,o,a,r,c=G){let d=[];d.push(new i(t-n/2,e-o/2)),d.push(new i(t+n/2,e-o/2)),d.push(new i(t+n/2,e+o/2)),d.push(new i(t-n/2,e+o/2));let u=new v(O.Polygon(d),1,r,a);u.style=c,this.bodies.push(u)}addFixedBall(t,e,n){this.bodies.push(new v(O.Circle(n,new i(t,e)),0)),this.bodies[this.bodies.length-1].style=S.Beige}addSpring(t){this.springs.push(t)}setBounds(t,e,n,o){let a=(r,c,d,u)=>{let h=[];return h.push(new i(r-d/2,c-u/2)),h.push(new i(r+d/2,c-u/2)),h.push(new i(r+d/2,c+u/2)),h.push(new i(r-d/2,c+u/2)),new v(O.Polygon(h),0)};this.bodies[0]=a(t-n,e,2*n,4*o),this.bodies[1]=a(t+2*n,e,2*n,4*o),this.bodies[2]=a(t,e-o,4*n,o*2),this.bodies[3]=a(t+n/2,e+2*o,5*n,2*o);for(let r=0;r<4;r+=1)this.bodies[r].style=S.Beige}getObjectAtCoordinates(t,e,n=0){let o=!1,a=new i(t,e);return this.bodies.some((r,c)=>r.containsPoint(a)&&c>=n?(o=r,!0):!1),o}removeObjFromSystem(t){let e=-1;if(t instanceof v&&(e=this.bodies.indexOf(t)),e!==-1){this.bodies.splice(e,1);return}(t instanceof Y||t instanceof B)&&(e=this.springs.indexOf(t)),e!==-1&&this.springs.splice(e,1)}getObjectIdentifier(t){return t instanceof v?{type:"body",index:this.bodies.indexOf(t)}:{type:"nothing",index:-1}}toJSON(){let t={};return t.airFriction=this.airFriction,t.gravity=this.gravity.toJSON(),t.bodies=this.bodies.map(e=>e.copy),t.springs=this.springs.map(e=>{let n={};return n.length=e.length,n.pinned=e.pinned,n.rotationLocked=e.rotationLocked,n.springConstant=e.springConstant,e instanceof B?n.type="spring":e instanceof Y&&(n.type="stick"),n.objects=e.objects.map(o=>this.getObjectIdentifier(o)),n}),t}stickOrSpringFromObject(t){let e={};return t.type==="spring"?e=new B(t.length,t.springConstant):t.type==="stick"&&(e=new Y(t.length)),e.pinned=t.pinned,e.rotationLocked=t.rotationLocked,e.objects=t.objects.map(n=>this.bodies[n.index]),e}static fromObject(t){let e=new ct;return e.bodies=t.bodies.map(n=>v.fromObject(n)),e.airFriction=t.airFriction,e.gravity=i.fromObject(t.gravity),e.springs=t.springs.map(n=>e.stickOrSpringFromObject(n)),e}};var tt=ct;var et,Zt,ht;function lt(s){Zt=s,s?ht.classList.add("bg-pink-darker"):ht.classList.remove("bg-pink-darker")}function St(s){et=s.getPhysics().toJSON(),ht=document.getElementById("set start"),lt(!1);let t=document.getElementById("pause");t&&(t.onclick=()=>{s.getTimeMultiplier()!==0?s.setTimeMultiplier(0):(s.setTimeMultiplier(1),Zt===!0&&(et=s.getPhysics().toJSON()),lt(!1))});let e=document.getElementById("revert");e&&(e.onclick=()=>{s.setTimeMultiplier(0),console.log(tt.fromObject(et)),s.setPhysics(tt.fromObject(et)),lt(!0)});let n=document.getElementById("clear all");n&&(n.onclick=()=>{lt(!0);let a=s.getPhysics();a.springs=[],a.bodies=[]}),ht&&(ht.onclick=()=>{et=s.getPhysics().toJSON(),console.log(et),lt(!0),s.setTimeMultiplier(0)});let o=!1;document.addEventListener("visibilitychange",()=>{document.hidden?s.getTimeMultiplier()!==0?(s.setTimeMultiplier(0),o=!0):o=!1:o&&s.setTimeMultiplier(1)})}function b(s,t,...e){let n=document.createElement(s);return t&&Object.entries(t).forEach(([o,a])=>{n[o]=a}),e&&e.forEach(o=>{typeof o=="string"?n.appendChild(document.createTextNode(o)):o instanceof HTMLElement&&n.appendChild(o)}),n}var _t=document.createElement("template");_t.innerHTML=`
  <style>
    .slider {
      -webkit-appearance: none;
      height: 0.6rem;
      background: var(--pinky-darker);
      outline: none;
      opacity: 0.7;
      -webkit-transition: 0.2s;
      transition: opacity 0.2s;
      border-radius: 100vh;
      width: 90%;
    }
    .slider:hover {
      opacity: 1;
    }
    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 0.8rem;
      height: 0.8rem;
      background: var(--blues-hover);
      opacity: 0.7;
      cursor: pointer;
      border-radius: 100vh;
    }
    .slider::-moz-range-thumb {
      width: 0.8rem;
      height: 0.8rem;
      background: var(--blues-hover);
      opacity: 0.7;
      cursor: pointer;
      border-radius: 100vh;
    }
    .slider-label {
      margin-top: 1em;
      margin-bottom: 0.3em;
      padding-left: 0em;
      font-weight: bold;
    }
    /* For tablets */
    @media (max-width: 768px) {
      .slider-label {
        font-weight: bold;
        margin-top: 0.5em;
        margin-bottom: 0rem;
        font-size: small;
      }
      .slider {
        height: 0.4rem;
      }
      .slider::-webkit-slider-thumb {
        width: 0.55rem;
        height: 0.55rem;
      }
      .slider::-moz-range-thumb {
        width: 0.55rem;
        height: 0.55rem;
      }
    }
  </style>
`;var At=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(_t.content.cloneNode(!0)),this.shadowRoot.appendChild(b("div",null,b("p",{className:"slider-label"},b("slot",null)),b("input",{id:"slider",type:"range",className:"slider"})))}get slider(){return this.shadowRoot.querySelector("#slider")}set min(t){this.slider.min=t}set max(t){this.slider.max=t}set step(t){this.slider.step=t}set value(t){this.slider.value=t}set onChange(t){this.slider.onchange=e=>t(e.target.valueAsNumber),this.slider.oninput=e=>t(e.target.valueAsNumber)}};window.customElements.define("range-slider",At);var te=document.createElement("template");te.innerHTML=`
  <style>
    .picker-label {
        display: flex;
        align-items: center;
        font-weight: bold;
        padding-right: 0.45em;
        margin-top: 1.3em;
    }
    #colorWell {
        margin-left: 0.5rem;
        border-radius: 100vh;
        background-color: var(--turquoise);
        border: none;
        height: 1rem;
        cursor: pointer;
    }
    /* For tablets */
    @media (max-width: 768px) {
      .picker-label {
        margin-top: 0.6em;
        font-size: small;
      }
      #colorWell {
        height: 1em;
      }
    }
  </style>
`;var ee=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(te.content.cloneNode(!0)),this.shadowRoot.appendChild(b("div",null,b("label",{htmlFor:"colorWell",className:"picker-label"},b("div",null,b("slot",null)),b("input",{type:"color",id:"colorWell"}))))}get picker(){return this.shadowRoot.querySelector("#colorWell")}set value(t){this.picker.value=t,this.picker.style["background-color"]=t}set onChange(t){let e=n=>{t(n.target.value),this.picker.style["background-color"]=n.target.value};this.picker.onchange=e,this.picker.oninput=e}};window.customElements.define("color-picker",ee);var bt=35,It=.5,Ct=1.5,Bt=Ut,se=document.createElement("div"),Ve={name:"Ball creator",description:"",element:se,drawFunc(s,t){let e=s.cnv.getContext("2d");e.strokeStyle="black",e.beginPath(),e.arc(s.mouseX,s.mouseY,bt,0,2*Math.PI),e.stroke(),s.lastX!==0&&s.lastY!==0&&(e.beginPath(),e.moveTo(s.mouseX,s.mouseY),e.lineTo(s.lastX,s.lastY),e.stroke())},startInteractionFunc(s){},endInteractionFunc(s){if(s.lastX!==0&&s.lastY!==0){let t=new v(O.Circle(bt,new i(s.lastX,s.lastY)),1,It,Ct);t.vel=new i(s.lastX-s.mouseX,s.lastY-s.mouseY),t.style=Bt,Number.isFinite(t.pos.x)&&Number.isFinite(t.pos.y)&&Number.isFinite(t.vel.x)&&Number.isFinite(t.vel.y)||(t.vel.x=0,t.vel.y=0),s.physics.addBody(t)}}};se.append(b("range-slider",{min:5,max:120,step:1,value:bt,onChange:s=>{bt=s}},"Size"),b("range-slider",{min:0,max:1,step:.02,value:It,onChange:s=>{It=s}},"Bounciness"),b("range-slider",{min:0,max:2,step:.1,value:Ct,onChange:s=>{Ct=s}},"Coefficient of friction"),b("color-picker",{value:Bt,onChange:s=>{Bt=s}},"Color:"));var ne=Ve;var We=document.createElement("div"),Ge={name:"Delete",description:"",element:We,drawFunc(s,t){},startInteractionFunc(s){s.choosed&&typeof s.choosed!="boolean"&&s.choosed instanceof v&&s.physics.removeObjFromSystem(s.choosed)}},ie=Ge;var oe=0,ae=0,Ue=document.createElement("div"),Je={name:"Move",description:"",element:Ue,drawFunc(s,t){let{choosed:e}=s;e instanceof v&&e.m!==0&&(e.move(new i(s.mouseX-e.pos.x,s.mouseY-e.pos.y)),t===0?(e.vel.x=0,e.vel.y=0):(e.vel.x=(s.mouseX-oe)/t,e.vel.y=(s.mouseY-ae)/t),e.ang=0),oe=s.mouseX,ae=s.mouseY},startInteractionFunc(s){let{choosed:t}=s;if(t instanceof v&&t.m!==0){let e=s;e.cnv.style.cursor="grabbing"}},endInteractionFunc(s){let{choosed:t}=s;if(t instanceof v&&t.m!==0){let e=s;e.cnv.style.cursor="grab"}},activated(s){let t=s;t.cnv.style.cursor="grab"},deactivated(s){let t=s;t.cnv.style.cursor="default"}},re=Je;var Qe=document.createElement("div"),Ke={name:"Rectangle wall",description:"",element:Qe,drawFunc(s,t){if(s.lastX!==0&&s.lastY!==0){let e=s.cnv.getContext("2d");e.strokeStyle="black",e.strokeRect(s.mouseX,s.mouseY,s.lastX-s.mouseX,s.lastY-s.mouseY)}},startInteractionFunc(s){},endInteractionFunc(s){if(s.lastX!==0&&s.lastY!==0){if(Math.abs(s.lastX-s.mouseX)<5&&Math.abs(s.lastY-s.mouseY)<5)return;s.physics.addRectWall(s.lastX/2+s.mouseX/2,s.lastY/2+s.mouseY/2,2*Math.abs(s.lastX/2-s.mouseX/2),2*Math.abs(s.lastY/2-s.mouseY/2));let t=s;t.physics.bodies[t.physics.bodies.length-1].style=S.Beige}}},ce=Ke;var Et=.2,Ot=.5,Xt=G,he=document.createElement("div"),$e={name:"Rectangle body",description:"",element:he,drawFunc(s,t){let e=s.cnv.getContext("2d");s.lastX!==0&&s.lastY!==0&&(e.strokeStyle="black",e.strokeRect(s.mouseX,s.mouseY,s.lastX-s.mouseX,s.lastY-s.mouseY))},startInteractionFunc(s){},endInteractionFunc(s){if(s.lastX!==0&&s.lastY!==0){let t=Math.abs(s.mouseX-s.lastX),e=Math.abs(s.mouseY-s.lastY);if(t/e>50||e/t>50||e===0||t===0)return;s.physics.addRectBody(s.lastX/2+s.mouseX/2,s.lastY/2+s.mouseY/2,2*Math.abs(s.lastX/2-s.mouseX/2),2*Math.abs(s.lastY/2-s.mouseY/2),Ot,Et,Xt)}},keyGotUpFunc(s){},keyGotDownFunc(s){}};he.append(b("range-slider",{min:0,max:.6,step:.02,value:Et,onChange:s=>{Et=s}},"Bounciness"),b("range-slider",{min:0,max:2,step:.1,value:Ot,onChange:s=>{Ot=s}},"Coefficient of friction"),b("color-picker",{value:Xt,onChange:s=>{Xt=s}},"Color:"));var le=$e;var gt=35,Yt=.5,Tt=.5,yt=4,xt=24,Rt=G,de=document.createElement("div");function ue(s=24,t=4){return[...new Array(s).keys()].map(e=>i.fromAnglePNorm(Math.PI*2*e/s,t))}var Ze={name:"Squircle creator",description:"",element:de,drawFunc(s,t){let e=s.cnv.getContext("2d");e.strokeStyle="black";let n=ue(xt,yt);n.forEach(o=>o.mult(gt)),e.beginPath(),e.moveTo(s.mouseX+n[0].x,s.mouseY+n[0].y);for(let o=1;o<n.length;o+=1)e.lineTo(s.mouseX+n[o].x,s.mouseY+n[o].y);e.closePath(),e.stroke(),s.mouseDown&&(e.beginPath(),e.moveTo(s.mouseX,s.mouseY),e.lineTo(s.lastX,s.lastY),e.stroke())},startInteractionFunc(s){},endInteractionFunc(s){let t=ue(xt,yt),e=new i(s.lastX,s.lastY);if(t.forEach(n=>{n.mult(gt),n.add(e)}),s.lastX!==0&&s.lastY!==0){let n=new v(O.Polygon(t),1,Yt,Tt);n.vel=new i(s.lastX-s.mouseX,s.lastY-s.mouseY),n.style=Rt,s.physics.addBody(n)}}};de.append(b("range-slider",{min:5,max:120,step:1,value:gt,onChange:s=>{gt=s}},"Size"),b("range-slider",{min:2,max:7,step:1,value:9-yt,onChange:s=>{yt=9-s}},"Roundness"),b("range-slider",{min:12,max:36,step:1,value:xt,onChange:s=>{xt=s}},"Resolution"),b("range-slider",{min:0,max:.9,step:.02,value:Yt,onChange:s=>{Yt=s}},"Bounciness"),b("range-slider",{min:0,max:2,step:.1,value:Tt,onChange:s=>{Tt=s}},"Coefficient of friction"),b("color-picker",{value:Rt,onChange:s=>{Rt=s}},"Color:"));var me=Ze;var z=35;var Lt=1.5,Ft=24,zt=1,fe=document.createElement("div"),_e={name:"Soft square creator",description:"",element:fe,drawFunc(s,t){let e=s.cnv.getContext("2d");e.strokeStyle="black",e.beginPath(),e.moveTo(s.mouseX-z,s.mouseY-z),e.lineTo(s.mouseX+z,s.mouseY-z),e.lineTo(s.mouseX+z,s.mouseY+z),e.lineTo(s.mouseX-z,s.mouseY+z),e.lineTo(s.mouseX-z,s.mouseY-z),e.stroke(),s.lastX!==0&&s.lastY!==0&&(e.beginPath(),e.moveTo(s.mouseX,s.mouseY),e.lineTo(s.lastX,s.lastY),e.stroke())},startInteractionFunc(s){},endInteractionFunc(s){s.lastX!==0&&s.lastY!==0&&s.physics.addSoftSquare(new i(s.lastX,s.lastY),z*2,Lt,new i(s.lastX-s.mouseX,s.lastY-s.mouseY),Ft,zt)}};fe.append(b("range-slider",{min:5,max:100,step:1,value:z,onChange:s=>{z=s}},"Size"),b("range-slider",{min:.4,max:3,step:.1,value:zt,onChange:s=>{zt=s}},"Pressure"),b("range-slider",{min:0,max:2,step:.1,value:Lt,onChange:s=>{Lt=s}},"Coefficient of friction"),b("range-slider",{min:16,max:48,step:8,value:Ft,onChange:s=>{Ft=s}},"Resolution"));var pe=_e;var be=document.createElement("template");be.innerHTML=`
  <style>
    .checkbox-label {
        font-weight: bold;
        padding-right: 0.45em;
        margin-top: 1.1em;
        display: flex;
    }
    .ch-box {
        display: none;
    }
    .checkbox-display {
        width: 1.15em;
        height: 1.15em;
        display: block;
        background-color: var(--roman-silver);
        margin-bottom: 0.3em;
        margin-right: 0.3em;
        margin-left: 0em;
        padding: 0;
        position: relative;
        border-radius: 0.2em;
        top: 0.2em;
        -webkit-transition: 0.2s;
        transition: background-color 0.2s;
        text-align: center;
        float: left;
    }
    input[type="checkbox"]:checked ~ .checkbox-display {
        background-color: var(--pinky-darker);
    }
    .checkbox-display:hover,
    .checkbox-label:hover > .checkbox-display {
        background-color: var(--independence);
    }
    input[type="checkbox"]:checked ~ .checkbox-display > .checkmark {
        transform: scale(1.2);
    }
    .checkmark {
        width: 75%;
        height: auto;
        fill: white;
        transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        transform: scale(0);
    }
    .label-text {
        margin-top: 0.2em;
        flex: 1;
    }
    .cursor-pointer > * {
        cursor: pointer;
    }
    /* For tablets */
    @media (max-width: 768px) {
      .checkbox-label {
        margin-top: 0.6em;
        font-size: small;
      }
    }
  </style>
`;var ge=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(be.content.cloneNode(!0)),this.shadowRoot.appendChild(b("div",{className:"cursor-pointer"},b("label",{htmlFor:"cbIdentifier",className:"checkbox-label"},b("input",{type:"checkbox",className:"ch-box",id:"cbIdentifier"}),b("div",{className:"checkbox-display"}),b("div",{className:"label-text"},b("slot",null))))),this.shadowRoot.querySelector(".checkbox-display").innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="122.877px" height="101.052px" viewBox="0 0 122.877 101.052" id="checkmark-svg" enable-background="new 0 0 122.877 101.052" xml:space="preserve"><g><path d="M4.43,63.63c-2.869-2.755-4.352-6.42-4.427-10.11c-0.074-3.689,1.261-7.412,4.015-10.281 c2.752-2.867,6.417-4.351,10.106-4.425c3.691-0.076,7.412,1.255,10.283,4.012l24.787,23.851L98.543,3.989l1.768,1.349l-1.77-1.355 c0.141-0.183,0.301-0.339,0.479-0.466c2.936-2.543,6.621-3.691,10.223-3.495V0.018l0.176,0.016c3.623,0.24,7.162,1.85,9.775,4.766 c2.658,2.965,3.863,6.731,3.662,10.412h0.004l-0.016,0.176c-0.236,3.558-1.791,7.035-4.609,9.632l-59.224,72.09l0.004,0.004 c-0.111,0.141-0.236,0.262-0.372,0.368c-2.773,2.435-6.275,3.629-9.757,3.569c-3.511-0.061-7.015-1.396-9.741-4.016L4.43,63.63 L4.43,63.63z"/></g></svg>',this.shadowRoot.querySelector("#checkmark-svg").classList.add("checkmark")}get checkbox(){return this.shadowRoot.querySelector("#cbIdentifier")}set checked(t){this.checkbox.checked=t}set onChange(t){this.checkbox.onchange=e=>t(e.target.checked)}};window.customElements.define("check-box",ge);var Dt=!1,dt=1e4,ye=document.createElement("div"),Ae={name:"Spring creator",description:"",element:ye,drawFunc(s,t){let e=s.cnv.getContext("2d");s.lastX!==0&&s.lastY!==0&&(e.strokeStyle="black",e.beginPath(),e.moveTo(s.mouseX,s.mouseY),e.lineTo(s.lastX,s.lastY),e.stroke())},startInteractionFunc(s){},endInteractionFunc(s){if(s.lastX!==0&&s.lastY!==0){let t=s.physics.getObjectAtCoordinates(s.mouseX,s.mouseY),e,n=B;if(typeof t=="boolean"&&(t={x:s.mouseX,y:s.mouseY,pinPoint:!0}),s.choosed===t||s.choosed===void 0&&t===void 0||s.choosed instanceof Object&&t instanceof Object&&"pinPoint"in s.choosed&&"pinPoint"in t||(s.choosed instanceof Object&&t instanceof Object&&"pinPoint"in s.choosed&&"pos"in t?(e=new n(Math.sqrt((s.choosed.x-t.pos.x)**2+(s.choosed.y-t.pos.y)**2),dt),e.attachObject(t),e.pinHere(s.choosed.x,s.choosed.y)):t instanceof Object&&s.choosed instanceof Object&&"pos"in s.choosed&&"pinPoint"in t?(e=new n(Math.sqrt((s.choosed.pos.x-t.x)**2+(s.choosed.pos.y-t.y)**2),dt),e.attachObject(s.choosed),e.pinHere(t.x,t.y)):s.choosed instanceof Object&&t instanceof Object&&"pos"in s.choosed&&"pos"in t&&(e=new n(Math.sqrt((s.choosed.pos.x-t.pos.x)**2+(s.choosed.pos.y-t.pos.y)**2),dt),e.attachObject(s.choosed),e.attachObject(t)),typeof e=="undefined"))return;s.physics.addSpring(e),Dt&&e.lockRotation()}}};ye.append(b("check-box",{checked:Dt,onChange:s=>{Dt=s}},"Lock rotation"),b("range-slider",{min:2e3,max:1e5,value:dt,step:200,onChange:s=>{dt=s}},"Spring stiffness"));var xe=Ae;var Nt=!1,jt=document.createElement("div"),ts={name:"Stick creator",description:"",element:jt,drawFunc(s,t){let e=s.cnv.getContext("2d");s.lastX!==0&&s.lastY!==0&&(e.strokeStyle="black",e.beginPath(),e.moveTo(s.mouseX,s.mouseY),e.lineTo(s.lastX,s.lastY),e.stroke())},startInteractionFunc(s){},endInteractionFunc(s){if(s.lastX!==0&&s.lastY!==0){let t=s.physics.getObjectAtCoordinates(s.mouseX,s.mouseY),e,n=Y;if(typeof t=="boolean"&&(t={x:s.mouseX,y:s.mouseY,pinPoint:!0}),typeof s.choosed=="boolean"||s.choosed===t||s.choosed===void 0&&t===void 0||"pinPoint"in s.choosed&&"pinPoint"in t||("pinPoint"in s.choosed&&"pos"in t?(e=new n(Math.sqrt((s.choosed.x-t.pos.x)**2+(s.choosed.y-t.pos.y)**2)),e.attachObject(t),e.pinHere(s.choosed.x,s.choosed.y)):"pinPoint"in t&&"pos"in s.choosed?(e=new n(Math.sqrt((s.choosed.pos.x-t.x)**2+(s.choosed.pos.y-t.y)**2)),e.attachObject(s.choosed),e.pinHere(t.x,t.y)):"pos"in s.choosed&&"pos"in t&&(e=new n(Math.sqrt((s.choosed.pos.x-t.pos.x)**2+(s.choosed.pos.y-t.pos.y)**2)),e.attachObject(s.choosed),e.attachObject(t)),typeof e=="undefined"))return;s.physics.addSpring(e),Nt&&e.lockRotation()}},keyGotUpFunc(s){},keyGotDownFunc(s){}};[b("check-box",{checked:Nt,onChange:s=>{Nt=s}},"Lock rotation")].forEach(jt.appendChild.bind(jt));var ve=ts;var vt=20,we=document.createElement("div"),es={name:"Wall drawer",description:"",element:we,drawFunc(s,t){let e=s.cnv.getContext("2d");e.strokeStyle="black",e.beginPath(),e.arc(s.mouseX,s.mouseY,vt,0,2*Math.PI),e.stroke(),s.lastX!==0&&s.lastY!==0&&s.physics.addFixedBall(s.mouseX,s.mouseY,vt)}};we.append(b("range-slider",{min:5,max:70,step:1,value:vt,onChange:s=>{vt=s}},"Size"));var Me=es;var ke=document.createElement("template");ke.innerHTML=`
  <style>
    .number {
      display: block;
      height: 0.6rem;
      background: var(--independence);
      outline: none;
      opacity: 0.7;
      -webkit-transition: 0.2s;
      transition: opacity 0.2s;
      border-bottom-right-radius: 0.3rem;
      border-bottom-left-radius: 0.3rem;
      padding: 0px;
      padding-top: 0.15rem;
      padding-bottom: 0.15rem;
      border: 0px;
      margin-left: 2px;
      margin-right: 2px;
      text-align: center;
      width: 90%;
      color: white;
    }
    .disabled {
      pointer-events: none;
      opacity: 0.5;
    }
    .number:hover {
      opacity: 1;
    }
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    input[type=number] {
      -moz-appearance: textfield;
    }
    .slider {
      -webkit-appearance: none;
      height: 0.6rem;
      background: var(--pinky-darker);
      outline: none;
      opacity: 0.7;
      -webkit-transition: 0.2s;
      transition: opacity 0.2s;
      border-top-left-radius: 0.3rem;
      border-top-right-radius: 0.3rem;
      width: 90%;
      margin-bottom: 0px;
      display: block;
    }
    .slider:hover {
      opacity: 1;
    }
    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 0.8rem;
      height: 0.8rem;
      background: var(--blues-hover);
      opacity: 0.7;
      cursor: pointer;
      border-radius: 100vh;
    }
    .slider::-moz-range-thumb {
      width: 0.8rem;
      height: 0.8rem;
      background: var(--blues-hover);
      opacity: 0.7;
      cursor: pointer;
      border-radius: 100vh;
    }
    .slider-label {
      margin-top: 1em;
      margin-bottom: 0.3em;
      padding-left: 0em;
      font-weight: bold;
    }
    /* For tablets */
    @media (max-width: 768px) {
      .slider-label {
        font-weight: bold;
        margin-top: 0.5em;
        margin-bottom: 0rem;
        font-size: small;
      }
      .slider {
        height: 0.4rem;
      }
      .slider::-webkit-slider-thumb {
        width: 0.55rem;
        height: 0.55rem;
      }
      .slider::-moz-range-thumb {
        width: 0.55rem;
        height: 0.55rem;
      }
    }
  </style>
`;var Pe=class extends HTMLElement{constructor(){super();this.minNum=0,this.maxNum=0,this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(ke.content.cloneNode(!0)),this.shadowRoot.appendChild(b("div",{id:"mainContainer"},b("p",{className:"slider-label"},b("slot",null)),b("input",{id:"slider",type:"range",className:"slider"}),b("input",{id:"number-input",type:"number",className:"number"})))}get slider(){return this.shadowRoot.querySelector("#slider")}get numInput(){return this.shadowRoot.querySelector("#number-input")}set min(t){this.slider.min=t,this.numInput.min=t,this.minNum=t}set max(t){this.slider.max=t,this.numInput.max=t,this.maxNum=t}set step(t){this.slider.step=t,this.numInput.step=t}set value(t){this.slider.value=t,this.numInput.value=t}normalizeValue(t){return Math.min(Math.max(this.minNum,t),this.maxNum)}disable(){this.shadowRoot.querySelector("#mainContainer").classList.add("disabled")}enable(){this.shadowRoot.querySelector("#mainContainer").classList.remove("disabled")}set onChange(t){this.slider.onchange=e=>{let n=this.normalizeValue(e.target.valueAsNumber).toString();t(Number.parseFloat(n)),this.value=n},this.slider.oninput=e=>{let n=this.normalizeValue(e.target.valueAsNumber).toString();t(Number.parseFloat(n)),this.value=n},this.numInput.onchange=e=>{let n=this.normalizeValue(e.target.valueAsNumber).toString();t(Number.parseFloat(n)),this.value=n}}};window.customElements.define("range-slider-number",Pe);var ss=document.createElement("div"),ns={name:"World settings",description:"",element:ss,init(s){let t=s;this.element.append(b("range-slider",{min:0,max:5e3,step:200,value:t.physics.gravity.y,onChange:e=>{t.physics.gravity.y=e}},"Gravity"),b("range-slider",{min:-5e3,max:5e3,step:1e3,value:t.physics.gravity.x,onChange:e=>{t.physics.gravity.x=e}},"Gravity in X direction"),b("range-slider",{min:0,max:.99,step:.01,value:1-t.physics.airFriction,onChange:e=>{t.physics.setAirFriction(1-e)}},"Air friction"),b("range-slider-number",{min:700,max:1e4,step:10,value:t.worldSize.width,onChange:e=>{t.setWorldSize({width:e,height:t.worldSize.height})}},"World width"),b("range-slider-number",{min:700,max:5e3,step:10,value:t.worldSize.height,onChange:e=>{t.setWorldSize({width:t.worldSize.width,height:e})}},"World height"),b("check-box",{checked:t.drawCollisions,onChange:e=>{t.drawCollisions=e}},"Show collision data"),b("check-box",{checked:t.showAxes,onChange:e=>{t.showAxes=e}},"Show body axes"),b("check-box",{checked:t.showBoundingBoxes,onChange:e=>{t.showBoundingBoxes=e}},"Show boounding boxes"))}},Se=ns;var Ie=document.createElement("template");Ie.innerHTML=`
  <style>
    .number-label {
        display: flex;
        align-items: center;
        font-weight: bold;
        padding-right: 0.45em;
        margin-top: 0.5em;
    }
    /* For tablets */
    @media (max-width: 768px) {
      .number-label {
        margin-top: 0.6em;
        font-size: small;
      }
    }
  </style>
`;var Ce=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(Ie.content.cloneNode(!0)),this.shadowRoot.appendChild(b("div",{className:"number-label"},b("span",null,b("slot",null)),b("span",{id:"numberPlace"})))}set value(t){this.shadowRoot.querySelector("#numberPlace").innerText=t}get value(){return this.shadowRoot.querySelector("#numberPlace").innerText}};window.customElements.define("number-display",Ce);var Be=document.createElement("template");Be.innerHTML=`
  <style>
    .number-label {
        display: flex;
        align-items: center;
        font-weight: bold;
        padding-right: 0.45em;
        margin-top: 0.5em;
    }
    #indicatorContainer {
        display: inline-block;
        width: 1em;
        height: 1em;
        background: var(--pinky-darker);
        border-radius: 100vh;
        align-text: center;
    }
    #rotationIndicator {
        transform: translateY(0.1em) rotate(0deg);
        position: relative;
        width: 0.8em;
        border-top: 0.1em solid white;
        border-bottom: 0.1em solid white;
        border-right: 0.2em solid black;
    }
    /* For tablets */
    @media (max-width: 768px) {
      .number-label {
        margin-top: 0.6em;
        font-size: small;
      }
    }
  </style>
`;var Ee=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(Be.content.cloneNode(!0)),this.shadowRoot.appendChild(b("div",{className:"number-label"},b("span",null,b("slot",null)),b("div",{id:"indicatorContainer"},b("hr",{id:"rotationIndicator"})),b("span",null,"\xA0"),b("span",{id:"numberPlace"}),b("span",null,"\xB0")))}set value(t){let e=t*180/Math.PI%360;this.shadowRoot.querySelector("#numberPlace").innerText=Math.abs(e).toFixed(),this.shadowRoot.querySelector("#rotationIndicator").style.transform=`translateY(-0.1em) rotate(${e}deg)`}get value(){return this.shadowRoot.querySelector("#numberPlace").innerText}};window.customElements.define("angle-display",Ee);var U=7,J=6.5,Ht=8,qt=25,st=7,f=!1,M=!1,nt=document.createElement("div"),D,q=0,I=1,T="none";function Oe(s){return s.physics.getObjectAtCoordinates(s.mouseX,s.mouseY,4)}function Vt(s){if(s.timeMultiplier!==0&&!(f instanceof v&&f.m===0))return"none";if(f instanceof v){let t=f.boundingBox,e=new i(t.x.min,t.y.min),n=new i(t.x.max,t.y.min),o=new i(t.x.min,t.y.max),a=new i(t.x.max,t.y.max),r=i.add(i.lerp(n,e,.5),new i(0,-qt)),c=new i(s.mouseX,s.mouseY);if(i.dist(r,c)<=Ht)return"rotate";if(i.dist(o,c)<=U)return"resize-bl";if(i.dist(a,c)<=U)return"resize-br";if(i.dist(e,c)<=U)return"resize-tl";if(i.dist(n,c)<=U)return"resize-tr";if(i.dist(i.lerp(n,e,.5),c)<=J)return"resize-t";if(i.dist(i.lerp(a,o,.5),c)<=J)return"resize-b";if(i.dist(i.lerp(e,o,.5),c)<=J)return"resize-l";if(i.dist(i.lerp(n,a,.5),c)<=J)return"resize-r";if(c.x>=e.x&&c.y>=e.y&&c.x<=a.x&&c.y<=a.y)return"move"}else if(typeof M!="boolean"){let t=M.points,e=new i(s.mouseX,s.mouseY);if(t[0].dist(e)<=st)return"move-spring0";if(t[1].dist(e)<=st)return"move-spring1"}return"none"}function is(s){if(!(f instanceof v))return;let t=f.boundingBox,e=new i(t.x.min,t.y.min),n=new i(t.x.max,t.y.min),o=new i(t.x.min,t.y.max),a=new i(t.x.max,t.y.max);I=1,s==="rotate"&&(q=f.rotation),s==="resize-bl"&&(q=i.sub(o,n).heading),s==="resize-br"&&(q=i.sub(a,e).heading),s==="resize-tl"&&(q=i.sub(e,a).heading),s==="resize-tr"&&(q=i.sub(n,o).heading),s==="resize-t"&&(q=new i(0,-1).heading),s==="resize-b"&&(q=new i(0,1).heading),s==="resize-l"&&(q=new i(-1,0).heading),s==="resize-r"&&(q=new i(1,0).heading)}function Xe(s){if(typeof f!="boolean"){let t=new i(s.mouseX,s.mouseY),e=new i(s.oldMouseX,s.oldMouseY),n=i.sub(e,f.pos),o=i.sub(t,f.pos),a=f.boundingBox,r=new i(a.x.min,a.y.min),c=new i(a.x.max,a.y.min),d=new i(a.x.min,a.y.max),u=new i(a.x.max,a.y.max),h=i.lerp(r,c,.5),l=i.lerp(d,u,.5),p=i.lerp(u,c,.5),m=i.lerp(d,r,.5),y=i.fromAngle(q),g=1;switch(T){case"move":f.move(new i(s.mouseX-s.oldMouseX,s.mouseY-s.oldMouseY));break;case"rotate":f.rotate(o.heading-n.heading);break;case"resize-bl":g=i.dot(y,i.sub(t,c))/i.dot(y,i.sub(e,c)),g*I>=.03?(f.scaleAround(c,g),I*=g):T="none";break;case"resize-br":g=i.dot(y,i.sub(t,r))/i.dot(y,i.sub(e,r)),g*I>=.03?(f.scaleAround(r,g),I*=g):T="none";break;case"resize-tl":g=i.dot(y,i.sub(t,u))/i.dot(y,i.sub(e,u)),g*I>=.03?(f.scaleAround(u,g),I*=g):T="none";break;case"resize-tr":g=i.dot(y,i.sub(t,d))/i.dot(y,i.sub(e,d)),g*I>=.03?(f.scaleAround(d,g),I*=g):T="none";break;case"resize-t":g=i.dot(y,i.sub(t,l))/i.dot(y,i.sub(e,l)),g*I>=.1?(f.scaleAroundY(l,g),I*=g):T="none";break;case"resize-b":g=i.dot(y,i.sub(t,h))/i.dot(y,i.sub(e,h)),g*I>=.1?(f.scaleAroundY(h,g),I*=g):T="none";break;case"resize-l":g=i.dot(y,i.sub(t,p))/i.dot(y,i.sub(e,p)),g*I>=.1?(f.scaleAroundX(p,g),I*=g):T="none";break;case"resize-r":g=i.dot(y,i.sub(t,m))/i.dot(y,i.sub(e,m)),g*I>=.1?(f.scaleAroundX(m,g),I*=g):T="none";break;default:break}}else if(typeof M!="boolean"){let t=new i(s.mouseX,s.mouseY),e=new i(s.oldMouseX,s.oldMouseY),n=i.sub(t,e);switch(T){case"move-spring0":M.updateAttachPoint0(t,st);break;case"move-spring1":M.updateAttachPoint1(t,st);break;default:break}}}var Ye={none:"default",move:"move",rotate:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAyklEQVQ4T6XST0qCQRjH8Y8JBnoCr9DGjXQBEbqDm6QQgvZeoX0bQVy7cRtBeIPcewi3bYLKeF6mmAZBeZvN8Pz5PvOb53ka/p4mHnGDVgp9YIVrvCdft5FxV3guCpXmBD1sfsAhXrKseOUVcV/ivKgwDvAMn1ngFosisVRTgQ+YpsQ7zA7IjX/fZ/4KfEMHX4jmlKePUeFcBrhPzi0ujjTnN/wv8JjUXMQO7fjWqc0JeIB1qvJUdxydOgtQjazOys1Dbg6GfeqS+wZwAS6Pac4meQAAAABJRU5ErkJggg==') 6.5 6.5, auto","resize-bl":"nesw-resize","resize-br":"nwse-resize","resize-tl":"nwse-resize","resize-tr":"nesw-resize","resize-t":"ns-resize","resize-b":"ns-resize","resize-l":"ew-resize","resize-r":"ew-resize","move-spring0":"move","move-spring1":"move"};function Te(s){let t=new i(s.mouseX,s.mouseY),e=s.physics.springs.find(n=>n.getAsSegment().distFromPoint(t)<=st);return typeof e=="undefined"?!1:e}function os(s,t){if(f instanceof v)if(T!=="rotate"){s.strokeStyle=S["Roman Silver"],s.setLineDash([5,3.5]),s.strokeRect(f.boundingBox.x.min,f.boundingBox.y.min,f.boundingBox.x.max-f.boundingBox.x.min,f.boundingBox.y.max-f.boundingBox.y.min),s.beginPath(),s.moveTo(f.boundingBox.x.max/2+f.boundingBox.x.min/2,f.boundingBox.y.min),s.lineTo(f.boundingBox.x.max/2+f.boundingBox.x.min/2,f.boundingBox.y.min-qt),s.stroke(),s.fillStyle=S.blue,s.beginPath(),s.arc(f.boundingBox.x.min,f.boundingBox.y.min,U,0,Math.PI*2),s.fill(),s.beginPath(),s.arc(f.boundingBox.x.min,f.boundingBox.y.max,U,0,Math.PI*2),s.fill(),s.beginPath(),s.arc(f.boundingBox.x.max,f.boundingBox.y.min,U,0,Math.PI*2),s.fill(),s.beginPath(),s.arc(f.boundingBox.x.max,f.boundingBox.y.max,U,0,Math.PI*2),s.fill(),s.beginPath(),s.arc(f.boundingBox.x.min,f.boundingBox.y.min/2+f.boundingBox.y.max/2,J,0,Math.PI*2),s.fill(),s.beginPath(),s.arc(f.boundingBox.x.max,f.boundingBox.y.min/2+f.boundingBox.y.max/2,J,0,Math.PI*2),s.fill(),s.beginPath(),s.arc(f.boundingBox.x.max/2+f.boundingBox.x.min/2,f.boundingBox.y.max,J,0,Math.PI*2),s.fill(),s.beginPath(),s.arc(f.boundingBox.x.max/2+f.boundingBox.x.min/2,f.boundingBox.y.min,J,0,Math.PI*2),s.fill(),s.beginPath(),s.arc(f.boundingBox.x.max/2+f.boundingBox.x.min/2,f.boundingBox.y.min-qt,Ht,0,Math.PI*2),s.fill();let e=Vt(t),n=Ye[e],o=t.cnv.style;o.cursor!==n&&(o.cursor=n)}else s.strokeStyle=S["Roman Silver"],s.setLineDash([5,3.5]),s.beginPath(),s.moveTo(f.pos.x,f.pos.y),s.lineTo(t.mouseX,t.mouseY),s.stroke(),s.fillStyle=S.blue,s.beginPath(),s.arc(t.mouseX,t.mouseY,Ht,0,Math.PI*2),s.fill()}function as(s,t){if(typeof M!="boolean"){let e=M.points;s.fillStyle=S.blue,s.beginPath(),e.forEach(r=>{s.arc(r.x,r.y,st,0,Math.PI*2)}),s.fill();let n=Vt(t),o=Ye[n],a=t.cnv.style;a.cursor!==o&&(a.cursor=o)}}function rs(s){let t=Te(s);if(typeof t!="boolean"){M=t;let e=b("number-display",{value:M.getAsSegment().length.toFixed(1)},"Length:\xA0"),n=b("range-slider-number",{min:15,max:Math.max(s.worldSize.width,s.worldSize.height),step:1,value:M.length.toFixed(1),onChange:o=>{typeof M!="boolean"&&(M.length=o)}},"Start length");nt.append(b("number-display",{value:M instanceof Y?"stick":"spring"},"Type:\xA0"),e,n,b("check-box",{checked:M.rotationLocked,onChange:o=>{typeof M!="boolean"&&(o?M.lockRotation():M.unlockRotation())}},"Locked")),D=()=>{typeof M!="boolean"&&(e.value=M.getAsSegment().length.toFixed(1))}}else M=!1}var cs={name:"Select",description:"",element:nt,drawFunc(s,t){let e=Oe(s),n=Te(s),o=s.cnv.getContext("2d");if(o.save(),o.strokeStyle="orange",o.setLineDash([]),o.lineWidth=4,typeof f!="boolean"){if(f.shape.r!==0)o.beginPath(),o.arc(f.pos.x,f.pos.y,f.shape.r,0,Math.PI*2),o.stroke();else{o.beginPath(),o.moveTo(f.shape.points[0].x,f.shape.points[0].y);for(let a=1;a<f.shape.points.length;a+=1)o.lineTo(f.shape.points[a].x,f.shape.points[a].y);o.closePath(),o.stroke()}(f.m===0||s.timeMultiplier===0)&&(Xe(s),os(o,s))}else{let a=s.cnv.style;a.cursor!=="default"&&(a.cursor="default")}if(typeof M!="boolean")o.fillStyle="#00000000",M instanceof Y?s.renderer.renderStick(M,o):M instanceof B&&s.renderer.renderSpring(M,o),s.timeMultiplier===0&&(Xe(s),as(o,s));else if(typeof f=="boolean"){let a=s.cnv.style;a.cursor!=="default"&&(a.cursor="default")}if(o.strokeStyle="yellow",o.setLineDash([3,5]),typeof e!="boolean")if(e.shape.r!==0)o.beginPath(),o.arc(e.pos.x,e.pos.y,e.shape.r,0,Math.PI*2),o.stroke();else{o.beginPath(),o.moveTo(e.shape.points[0].x,e.shape.points[0].y);for(let a=1;a<e.shape.points.length;a+=1)o.lineTo(e.shape.points[a].x,e.shape.points[a].y);o.closePath(),o.stroke()}else typeof n!="boolean"&&(o.fillStyle="#00000000",n instanceof Y?s.renderer.renderStick(n,o):s.renderer.renderSpring(n,o));o.restore(),D==null||D()},startInteractionFunc(s){let t=Vt(s);if(t!=="none"){T=t,is(t);return}T="none";let e=Oe(s);if(e instanceof v&&f!==e&&t==="none"){nt.innerHTML="",f=e,M=!1;let n=b("range-slider-number",{min:.1,max:25,step:.05,value:Number.parseFloat(f.density.toFixed(2)),onChange:h=>{f instanceof v&&(f.density=h),D==null||D()}},"Density");f.m===0&&n.disable();let o=b("check-box",{checked:f.m===0,onChange:h=>{f instanceof v&&(h?(n.disable(),f.density=0,f.vel=new i(0,0),f.ang=0,n.value=0):(n.enable(),f.density=1,n.value=f.density),D==null||D())}},"Fixed down"),a=b("number-display",{value:f.shape.r!==0?"circle":"polygon"},"Type:\xA0"),r=b("number-display",{value:f.m.toFixed(2)},"Mass:\xA0"),c=b("number-display",{value:f.pos.x.toFixed(2)},"X coord:\xA0"),d=b("number-display",{value:f.pos.y.toFixed(2)},"Y coord:\xA0"),u=b("angle-display",{value:f.rotation.toFixed(2)},"Rotation:\xA0");D=()=>{f instanceof v&&(c.value!=f.pos.x&&(c.value=f.pos.x.toFixed(2)),d.value!=f.pos.y&&(d.value=f.pos.y.toFixed(2)),r.value!=f.m&&(r.value=f.m.toFixed(2)),u.value=f.rotation.toFixed(2))},nt.append(a,r,u,c,d,o,n,b("range-slider-number",{min:0,max:.98,step:.02,value:f.k,onChange:h=>{f instanceof v&&(f.k=h)}},"Bounciness"),b("range-slider-number",{min:0,max:2,step:.1,value:f.fc,onChange:h=>{f instanceof v&&(f.fc=h)}},"Coefficient of friction"),b("color-picker",{value:f.style,onChange:h=>{f instanceof v&&(f.style=h)}},"Color:"))}else typeof e=="boolean"&&t==="none"&&(f=e,D=()=>{},nt.innerHTML="",rs(s))},endInteractionFunc(s){T="none"},deactivated(){f=!1,M=!1,D=()=>{},nt.innerHTML=""}},Re=cs;var Le=[ne,Re,ce,Me,ve,xe,re,pe,ie,le,Se,me];var Fe=class{constructor(){this.textures=[]}renderSpring(t,e){let n=t.points,o=n[0].x,a=n[0].y,r=n[1].x,c=n[1].y,d=new i(r-o,c-a),u=d.copy;d.rotate(Math.PI/2),d.setMag(5);let h=new i(o,a),l=Math.floor(t.length/10);for(let p=1;p<=l;p+=1)p===l&&(d=new i(0,0)),e.beginPath(),e.moveTo(h.x,h.y),e.lineTo(o+p/l*u.x+d.x,a+p/l*u.y+d.y),e.stroke(),h=new i(o+p/l*u.x+d.x,a+p/l*u.y+d.y),d.mult(-1);e.strokeStyle="black",t.points.forEach(p=>{e.beginPath(),e.arc(p.x,p.y,2.5,0,Math.PI*2),e.fill(),e.stroke()})}renderStick(t,e){let n=t.points;e.beginPath(),e.moveTo(n[0].x,n[0].y),e.lineTo(n[1].x,n[1].y),e.stroke(),e.strokeStyle="black",t.points.forEach(o=>{e.beginPath(),e.arc(o.x,o.y,2.5,0,Math.PI*2),e.fill(),e.stroke()})}},ze=Fe;var V=Le,wt=V.map(s=>s.name),De=class{constructor(){this.resizeCanvas=()=>{let t=this.canvasHolder.getBoundingClientRect();this.cnv.width=t.width,this.cnv.height=window.innerHeight-t.top;let e=window.devicePixelRatio||1,n=t;this.cnv.width=n.width*e,this.cnv.height=n.height*e,this.cnv.style.width=`${n.width}px`,this.cnv.style.height=`${n.height}px`,this.scaling=this.cnv.height/this.worldSize.height,this.scaling/=e,this.scaling*=.9,this.viewOffsetX=.01*this.cnv.width,this.viewOffsetY=.03*this.cnv.height;let o=this.cnv.getContext("2d");o&&(o.scale(e,e),o.lineWidth=e),this.defaultSize=(this.cnv.width+this.cnv.height)/80};this.drawFunction=()=>{var n,o;Number.isFinite(this.lastFrameTime)||(this.lastFrameTime=performance.now());let t=performance.now()-this.lastFrameTime;Number.isFinite(t)||(t=0),t/=1e3,t=Math.min(t,.04166666666);let e=this.cnv.getContext("2d");e.fillStyle=S.Beige,e.fillRect(0,0,this.cnv.width,this.cnv.height),e.save(),e.translate(this.viewOffsetX,this.viewOffsetY),e.scale(this.scaling,this.scaling),this.physicsDraw(),(o=(n=V[this.mode]).drawFunc)==null||o.call(n,this,t*this.timeMultiplier),e.restore(),this.collisionData=[],t*=this.timeMultiplier,this.collisionData.push(...this.physics.update(t/5)),this.collisionData.push(...this.physics.update(t/5)),this.collisionData.push(...this.physics.update(t/5)),this.collisionData.push(...this.physics.update(t/5)),this.collisionData.push(...this.physics.update(t/5)),this.lastFrameTime=performance.now(),requestAnimationFrame(this.drawFunction),this.oldMouseX=this.mouseX,this.oldMouseY=this.mouseY};this.startInteraction=(t,e)=>{var n,o;this.mouseX=t/this.scaling-this.viewOffsetX/this.scaling,this.mouseY=e/this.scaling-this.viewOffsetY/this.scaling,this.oldMouseX=this.mouseX,this.oldMouseY=this.mouseY,this.choosed=this.physics.getObjectAtCoordinates(this.mouseX,this.mouseY),!this.choosed&&typeof this.choosed=="boolean"&&(this.choosed={x:this.mouseX,y:this.mouseY,pinPoint:!0}),this.lastX=this.mouseX,this.lastY=this.mouseY,this.mouseDown=!0,(o=(n=V[this.mode]).startInteractionFunc)==null||o.call(n,this)};this.endInteraction=(t,e)=>{var n,o;this.mouseX=t/this.scaling-this.viewOffsetX/this.scaling,this.mouseY=e/this.scaling-this.viewOffsetY/this.scaling,(o=(n=V[this.mode]).endInteractionFunc)==null||o.call(n,this),this.lastX=0,this.lastY=0,this.mouseDown=!1,this.choosed=!1};this.discardInteraction=()=>{this.lastX=0,this.lastY=0,this.mouseDown=!1,this.choosed=!1};this.keyGotDown=t=>{let e=t.key;e==="s"&&this.spawnNewtonsCradle(this.cnv.width/2,this.cnv.height/2,.5,this.physics),e==="a"&&(this.scaling+=.01),e==="d"&&(this.scaling-=.01),e==="j"&&(this.viewOffsetX-=10),e==="l"&&(this.viewOffsetX+=10),e==="k"&&(this.viewOffsetY-=10),e==="i"&&(this.viewOffsetY+=10)};this.keyGotUp=t=>{};this.startTouch=t=>{t.preventDefault();let e=this.canvasHolder.getBoundingClientRect();return t.touches.length>1?(this.discardInteraction(),t.touches.length===2&&(this.touchIDs.push(t.touches[0].identifier),this.touchIDs.push(t.touches[1].identifier),this.touchCoords.push(new i(t.touches[0].clientX-e.left,t.touches[0].clientY-e.top)),this.touchCoords.push(new i(t.touches[1].clientX-e.left,t.touches[1].clientY-e.top))),t.touches.length>2&&(this.touchIDs=[],this.touchCoords=[]),!1):(this.startInteraction(t.changedTouches[0].clientX-e.left,t.changedTouches[0].clientY-e.top),!1)};this.endTouch=t=>{t.preventDefault();let e=this.canvasHolder.getBoundingClientRect();return t.touches.length<=1&&(this.touchIDs=[],this.touchCoords=[]),this.endInteraction(t.changedTouches[0].clientX-e.left,t.changedTouches[0].clientY-e.top),!1};this.moveTouch=t=>{t.preventDefault();let e=this.canvasHolder.getBoundingClientRect();if(t.touches.length===2){let n=[];return t.touches.item(0).identifier===this.touchIDs[0]?(n.push(t.touches.item(0)),n.push(t.touches.item(1))):(n.push(t.touches.item(1)),n.push(t.touches.item(0))),n=n.map(o=>new i(o.clientX-e.left,o.clientY-e.top)),this.processMultiTouchGesture(this.touchCoords,n),this.touchCoords=n,!1}return t.touches.length>2||(this.mouseX=t.changedTouches[0].clientX-e.left,this.mouseY=t.changedTouches[0].clientY-e.top,this.mouseX=this.mouseX/this.scaling-this.viewOffsetX/this.scaling,this.mouseY=this.mouseY/this.scaling-this.viewOffsetY/this.scaling),!1};this.processMultiTouchGesture=(t,e)=>{let n=i.add(t[1],t[0]);n.mult(.5);let o=i.add(e[1],e[0]);o.mult(.5);let a=i.dist(t[1],t[0]),r=i.dist(e[1],e[0]),c=Math.sqrt(r/a),d=i.add(n,o);d.mult(.5);let u=i.sub(o,n);u.mult(c),this.scaleAround(d,c),this.viewOffsetX+=u.x,this.viewOffsetY+=u.y};this.scaleAround=(t,e)=>{this.viewOffsetX=t.x-(t.x-this.viewOffsetX)*e,this.viewOffsetY=t.y-(t.y-this.viewOffsetY)*e,this.scaling*=e};this.startMouse=t=>(t.button===0&&this.startInteraction(t.offsetX,t.offsetY),t.button===2&&(this.rightButtonDown=new i(t.offsetX,t.offsetY),this.cnv.style.cursor="all-scroll"),!1);this.endMouse=t=>(t.button===0&&this.endInteraction(t.offsetX,t.offsetY),t.button===2&&(this.rightButtonDown=!1,this.cnv.style.cursor="default"),!1);this.handleMouseMovement=t=>{if(this.mouseX=t.offsetX,this.mouseY=t.offsetY,this.mouseX=this.mouseX/this.scaling-this.viewOffsetX/this.scaling,this.mouseY=this.mouseY/this.scaling-this.viewOffsetY/this.scaling,this.rightButtonDown){let e=new i(t.offsetX,t.offsetY),n=i.sub(e,this.rightButtonDown);this.viewOffsetX+=n.x,this.viewOffsetY+=n.y,this.rightButtonDown=e}};this.handleMouseWheel=t=>{t.preventDefault();let e=new i(t.offsetX,t.offsetY),n=5e-4;t.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n/=16);let o=1-t.deltaY*n;this.scaleAround(e,o)};this.convertToPhysicsSpace=t=>new i(t.x/this.scaling-this.viewOffsetX/this.scaling,t.y/this.scaling-this.viewOffsetY/this.scaling);this.convertToCanvasSpace=t=>new i(t.x*this.scaling+this.viewOffsetX,t.y*this.scaling+this.viewOffsetY);this.physicsDraw=()=>{let t=this.cnv.getContext("2d");if(t){t.fillStyle=S.Independence,t.fillRect(0,0,this.worldSize.width,this.worldSize.height),this.physics.bodies.forEach(n=>{if(t.fillStyle=n.style,t.strokeStyle="black",n.m===0&&(t.strokeStyle="#00000000"),n.shape.r!==0){let o=n;t.beginPath(),t.arc(o.pos.x,o.pos.y,o.shape.r,0,2*Math.PI),t.stroke(),t.fill(),n.m!==0&&(t.beginPath(),t.moveTo(o.pos.x,o.pos.y),t.lineTo(o.pos.x+o.shape.r*Math.cos(o.rotation),o.pos.y+o.shape.r*Math.sin(o.rotation)),t.stroke())}else t.beginPath(),t.moveTo(n.shape.points[n.shape.points.length-1].x,n.shape.points[n.shape.points.length-1].y),n.shape.points.forEach(o=>{t.lineTo(o.x,o.y)}),t.stroke(),t.fill(),this.showAxes&&(t.strokeStyle="black",n.axes.forEach(o=>{t.beginPath(),t.moveTo(n.pos.x,n.pos.y),t.lineTo(n.pos.x+o.x*30,n.pos.y+o.y*30),t.stroke()}));n.m!==0&&(t.beginPath(),t.arc(n.pos.x,n.pos.y,1.5,0,Math.PI*2),t.stroke())}),t.save(),t.lineWidth=2,this.physics.springs.forEach(n=>{n instanceof B&&!(n instanceof Y)?(t.strokeStyle=S.blue,t.fillStyle=S.blue,this.renderer.renderSpring(n,t)):(t.strokeStyle=S.blue,t.fillStyle=S.blue,this.renderer.renderStick(n,t))}),t.restore(),t.strokeStyle="rgba(255, 255, 255, 0.2)",this.showBoundingBoxes&&this.physics.bodies.forEach(n=>{t.strokeRect(n.boundingBox.x.min,n.boundingBox.y.min,n.boundingBox.x.max-n.boundingBox.x.min,n.boundingBox.y.max-n.boundingBox.y.min)}),t.fillStyle=S["Maximum Yellow Red"],t.strokeStyle=S["Maximum Yellow Red"];let e=t.lineWidth;t.lineWidth=4,this.drawCollisions&&this.collisionData.forEach(n=>{t.beginPath(),t.moveTo(n.cp.x,n.cp.y),t.lineTo(n.cp.x+n.n.x*30,n.cp.y+n.n.y*30),t.stroke(),t.beginPath(),t.arc(n.cp.x,n.cp.y,4,0,Math.PI*2),t.fill()}),t.lineWidth=e}};this.spawnNewtonsCradle=(t,e,n,o)=>{let a=[],r=25,c=250,d=8;a.push(new v(O.Circle(n*r,new i(t,e)),1,1,0));let u=1;for(let h=0;h<d-1;h+=1)a.push(new v(O.Circle(n*r,new i(t+u*n*r*1.01*2,e)),1,1,0)),u*=-1,u>0&&(u+=1),h===d-2&&(a[a.length-1].vel.x=-Math.sign(u)*n*r*8);a.forEach(h=>{o.addBody(h);let l=new Y(c);l.attachObject(h),l.pinHere(h.pos.x,h.pos.y-c),o.addSpring(l),l.lockRotation()})};this.modeButtonClicked=t=>{let e=t.target.id.replace("-btn",""),n=wt.indexOf(e);this.switchToMode(n)};this.switchToMode=t=>{var o,a,r,c;let e=document.getElementById(`${wt[this.mode]}-btn`);e&&e.classList.remove("bg-pink-darker"),this.sidebar.innerHTML="",(a=(o=V[this.mode]).deactivated)==null||a.call(o,this),(c=(r=V[t]).activated)==null||c.call(r,this);let n=document.getElementById(`${wt[t]}-btn`);n&&n.classList.add("bg-pink-darker"),this.modeTitleHolder.innerText=V[t].name,this.mode=t,this.sidebar.appendChild(V[this.mode].element)};this.setupModes=()=>{let t=document.getElementById("button-holder");wt.forEach((e,n)=>{var a,r;let o=document.createElement("div");o.classList.add("big-button"),o.id=`${e}-btn`,o.textContent=V[n].name,(r=(a=V[n]).init)==null||r.call(a,this),o.onclick=this.modeButtonClicked,t&&t.appendChild(o)}),this.switchToMode(this.mode)};this.setTimeMultiplier=t=>{Number.isFinite(t)&&t>=0&&(this.timeMultiplier=t,t===0?this.pauseBtn.classList.add("bg-pink-darker"):this.pauseBtn.classList.remove("bg-pink-darker"))};this.getTimeMultiplier=()=>this.timeMultiplier;this.setPhysics=t=>{t instanceof tt&&(this.physics=t)};this.getPhysics=()=>this.physics;this.physics=new tt,this.mouseX=0,this.mouseY=0,this.oldMouseX=0,this.oldMouseY=0,this.mouseDown=!1,this.defaultSize=30,this.k=.5,this.fc=2,this.springConstant=2e3,this.scaling=1,this.viewOffsetX=0,this.viewOffsetY=0,this.mode=0,this.lastX=0,this.lastY=0,this.touchIDs=[],this.touchCoords=[],this.rightButtonDown=!1,this.timeMultiplier=1,this.lastFrameTime=performance.now(),this.choosed=!1,this.drawCollisions=!1,this.showAxes=!1,this.worldSize={width:0,height:0},this.collisionData=[],this.showBoundingBoxes=!1,this.renderer=new ze,this.cnv=document.getElementById("defaulCanvas0"),this.canvasHolder=document.getElementById("canvas-holder"),this.sidebar=document.getElementById("sidebar"),this.modeTitleHolder=document.getElementById("mode-title-text"),this.pauseBtn=document.getElementById("pause"),this.setWorldSize({width:2e3,height:1e3}),this.physics.setGravity(new i(0,1e3)),this.physics.setAirFriction(.9),this.cnv.addEventListener("touchstart",this.startTouch,!1),this.cnv.addEventListener("touchend",this.endTouch,!1),this.cnv.addEventListener("touchmove",this.moveTouch,!1),this.cnv.addEventListener("mousedown",this.startMouse,!1),this.cnv.addEventListener("mouseup",this.endMouse,!1),this.cnv.addEventListener("mousemove",this.handleMouseMovement,!1),this.cnv.addEventListener("wheel",this.handleMouseWheel),this.cnv.addEventListener("contextmenu",t=>t.preventDefault()),document.addEventListener("keydown",this.keyGotDown,!1),document.addEventListener("keyup",this.keyGotUp,!1),window.addEventListener("resize",this.resizeCanvas,!1),this.resizeCanvas(),this.setupModes(),St(this),requestAnimationFrame(this.drawFunction)}setWorldSize(t){this.physics.setBounds(0,0,t.width,t.height),this.worldSize=t}},Ne=De;window.onload=()=>{window.editorApp=new Ne,"serviceWorker"in navigator&&navigator.serviceWorker.register("serviceworker.js").then(()=>{},s=>{console.log("ServiceWorker registration failed: ",s)})};})();
